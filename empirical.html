<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Empirical plots from FROC data | The RJafroc Froc Book</title>
  <meta name="description" content="Artificial intelligence and observer performance book based on RJafroc." />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Empirical plots from FROC data | The RJafroc Froc Book" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Artificial intelligence and observer performance book based on RJafroc." />
  <meta name="github-repo" content="dpc10ster/RJafrocFrocBook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Empirical plots from FROC data | The RJafroc Froc Book" />
  
  <meta name="twitter:description" content="Artificial intelligence and observer performance book based on RJafroc." />
  

<meta name="author" content="Dev P. Chakraborty, PhD" />


<meta name="date" content="2022-11-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="froc-paradigm.html"/>
<link rel="next" href="visual-search.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">RJafroc documentation</a></li>

<li class="divider"></li>
<li class="part"><span><b>Preamble</b></span></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Please ignore preface</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#please-ignore-issues"><i class="fa fa-check"></i><b>1.1</b> Please ignore issues</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#please-ignore-following-sections"><i class="fa fa-check"></i><b>1.2</b> Please ignore following sections</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#tba-rationale-and-organization"><i class="fa fa-check"></i><b>1.3</b> TBA Rationale and Organization</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#tba-acknowledgements"><i class="fa fa-check"></i><b>1.4</b> TBA Acknowledgements</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#tba-nearly-finished-chapters"><i class="fa fa-check"></i><b>1.5</b> TBA Nearly finished chapters</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#the-pdf-file-of-the-book"><i class="fa fa-check"></i><b>1.6</b> The pdf file of the book</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#please-ignore-tba-how-much-finished-hmf"><i class="fa fa-check"></i><b>1.7</b> Please ignore: TBA How much finished HMF</a></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#please-ignore-a-note-on-the-online-distribution-mechanism-of-the-book"><i class="fa fa-check"></i><b>1.8</b> Please ignore: A note on the online distribution mechanism of the book</a></li>
<li class="chapter" data-level="1.9" data-path="index.html"><a href="index.html#please-ignore-structure-of-the-book"><i class="fa fa-check"></i><b>1.9</b> Please ignore: Structure of the book</a></li>
<li class="chapter" data-level="1.10" data-path="index.html"><a href="index.html#please-ignore-contributing-to-this-book"><i class="fa fa-check"></i><b>1.10</b> Please ignore Contributing to this book</a></li>
<li class="chapter" data-level="1.11" data-path="index.html"><a href="index.html#please-ignore-is-this-book-relevant-to-you-and-what-are-the-alternatives"><i class="fa fa-check"></i><b>1.11</b> Please ignore: Is this book relevant to you and what are the alternatives?</a></li>
<li class="chapter" data-level="1.12" data-path="index.html"><a href="index.html#please-ignore-chapters-needing-heavy-edits"><i class="fa fa-check"></i><b>1.12</b> Please ignore: Chapters needing heavy edits</a></li>
<li class="chapter" data-level="1.13" data-path="index.html"><a href="index.html#please-ignore-shelved-vs.-removed-vs.-parked-folders-needing-heavy-edits"><i class="fa fa-check"></i><b>1.13</b> Please ignore: Shelved vs. removed vs. parked folders needing heavy edits</a></li>
<li class="chapter" data-level="1.14" data-path="index.html"><a href="index.html#please-ignore-coding-aids-for-me"><i class="fa fa-check"></i><b>1.14</b> Please ignore: Coding aids (for me)</a><ul>
<li class="chapter" data-level="1.14.1" data-path="index.html"><a href="index.html#formatting"><i class="fa fa-check"></i><b>1.14.1</b> formatting</a></li>
<li class="chapter" data-level="1.14.2" data-path="index.html"><a href="index.html#tables"><i class="fa fa-check"></i><b>1.14.2</b> tables</a></li>
<li class="chapter" data-level="1.14.3" data-path="index.html"><a href="index.html#tinytex-problems"><i class="fa fa-check"></i><b>1.14.3</b> tinytex problems</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>FROC paradigm</b></span></li>
<li class="chapter" data-level="2" data-path="froc-paradigm.html"><a href="froc-paradigm.html"><i class="fa fa-check"></i><b>2</b> The FROC paradigm and visual search</a><ul>
<li class="chapter" data-level="2.1" data-path="froc-paradigm.html"><a href="froc-paradigm.html#froc-paradigm-how-much-finished"><i class="fa fa-check"></i><b>2.1</b> How much finished</a></li>
<li class="chapter" data-level="2.2" data-path="froc-paradigm.html"><a href="froc-paradigm.html#froc-paradigm-intro"><i class="fa fa-check"></i><b>2.2</b> Introduction</a><ul>
<li class="chapter" data-level="2.2.1" data-path="froc-paradigm.html"><a href="froc-paradigm.html#froc-paradigm-outline"><i class="fa fa-check"></i><b>2.2.1</b> Chapter outline</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="froc-paradigm.html"><a href="froc-paradigm.html#froc-paradigm-location-specific-paradigms"><i class="fa fa-check"></i><b>2.3</b> Location specific paradigms</a></li>
<li class="chapter" data-level="2.4" data-path="froc-paradigm.html"><a href="froc-paradigm.html#froc-paradigm-vis-search"><i class="fa fa-check"></i><b>2.4</b> Visual search</a><ul>
<li class="chapter" data-level="2.4.1" data-path="froc-paradigm.html"><a href="froc-paradigm.html#froc-paradigm-scoring-the-data"><i class="fa fa-check"></i><b>2.4.1</b> Proximity criterion and scoring the data</a></li>
<li class="chapter" data-level="2.4.2" data-path="froc-paradigm.html"><a href="froc-paradigm.html#multiple-marks-in-the-same-vicinity"><i class="fa fa-check"></i><b>2.4.2</b> Multiple marks in the same vicinity</a></li>
<li class="chapter" data-level="2.4.3" data-path="froc-paradigm.html"><a href="froc-paradigm.html#historical-context"><i class="fa fa-check"></i><b>2.4.3</b> Historical context</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="froc-paradigm.html"><a href="froc-paradigm.html#froc-paradigm-froc-plot"><i class="fa fa-check"></i><b>2.5</b> The FROC plot</a><ul>
<li class="chapter" data-level="2.5.1" data-path="froc-paradigm.html"><a href="froc-paradigm.html#froc-paradigm-plot-illustration"><i class="fa fa-check"></i><b>2.5.1</b> Illustration with a dataset</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="froc-paradigm.html"><a href="froc-paradigm.html#froc-paradigm-solar-analogy"><i class="fa fa-check"></i><b>2.6</b> The “solar” analogy</a></li>
<li class="chapter" data-level="2.7" data-path="froc-paradigm.html"><a href="froc-paradigm.html#froc-paradigm-discussion"><i class="fa fa-check"></i><b>2.7</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="empirical.html"><a href="empirical.html"><i class="fa fa-check"></i><b>3</b> Empirical plots from FROC data</a><ul>
<li class="chapter" data-level="3.1" data-path="empirical.html"><a href="empirical.html#empirical-how-much-finished"><i class="fa fa-check"></i><b>3.1</b> How much finished</a></li>
<li class="chapter" data-level="3.2" data-path="empirical.html"><a href="empirical.html#empirical-intro"><i class="fa fa-check"></i><b>3.2</b> Introduction</a></li>
<li class="chapter" data-level="3.3" data-path="empirical.html"><a href="empirical.html#empirical-mark-rating-pairs"><i class="fa fa-check"></i><b>3.3</b> FROC data and notation</a><ul>
<li class="chapter" data-level="3.3.1" data-path="empirical.html"><a href="empirical.html#lls-vs.-nls"><i class="fa fa-check"></i><b>3.3.1</b> LLs vs. NLs</a></li>
<li class="chapter" data-level="3.3.2" data-path="empirical.html"><a href="empirical.html#latent-vs.-actual-marks"><i class="fa fa-check"></i><b>3.3.2</b> Latent vs. actual marks</a></li>
<li class="chapter" data-level="3.3.3" data-path="empirical.html"><a href="empirical.html#z-samples-vs.-ratings"><i class="fa fa-check"></i><b>3.3.3</b> z-samples vs. ratings</a></li>
<li class="chapter" data-level="3.3.4" data-path="empirical.html"><a href="empirical.html#binning-rule"><i class="fa fa-check"></i><b>3.3.4</b> Binning rule</a></li>
<li class="chapter" data-level="3.3.5" data-path="empirical.html"><a href="empirical.html#empirical-notation"><i class="fa fa-check"></i><b>3.3.5</b> Notation</a></li>
<li class="chapter" data-level="3.3.6" data-path="empirical.html"><a href="empirical.html#comments"><i class="fa fa-check"></i><b>3.3.6</b> Comments</a></li>
<li class="chapter" data-level="3.3.7" data-path="empirical.html"><a href="empirical.html#empirical-indexing-marks"><i class="fa fa-check"></i><b>3.3.7</b> A conceptual and notatonal issue</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="empirical.html"><a href="empirical.html#empirical-froc-plot-1"><i class="fa fa-check"></i><b>3.4</b> The FROC plot</a><ul>
<li class="chapter" data-level="3.4.1" data-path="empirical.html"><a href="empirical.html#empirical-end-point"><i class="fa fa-check"></i><b>3.4.1</b> The observed FROC end-point and its semi-constrained property</a></li>
<li class="chapter" data-level="3.4.2" data-path="empirical.html"><a href="empirical.html#empirical-froc-plot-futility-extrapolation"><i class="fa fa-check"></i><b>3.4.2</b> Futility of extrapolation outside the observed end-point</a></li>
<li class="chapter" data-level="3.4.3" data-path="empirical.html"><a href="empirical.html#empirical-froc-plot-illustration"><i class="fa fa-check"></i><b>3.4.3</b> Illustration with a dataset</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="empirical.html"><a href="empirical.html#empirical-ROC"><i class="fa fa-check"></i><b>3.5</b> The inferred-ROC plot</a><ul>
<li class="chapter" data-level="3.5.1" data-path="empirical.html"><a href="empirical.html#empirical-ROC-fpf"><i class="fa fa-check"></i><b>3.5.1</b> The inferred-ROC z-sample</a></li>
<li class="chapter" data-level="3.5.2" data-path="empirical.html"><a href="empirical.html#empirical-ROC-tpf"><i class="fa fa-check"></i><b>3.5.2</b> Inferred TPF</a></li>
<li class="chapter" data-level="3.5.3" data-path="empirical.html"><a href="empirical.html#empirical-definition-empirical-auc-roc"><i class="fa fa-check"></i><b>3.5.3</b> The empirical ROC plot and AUC</a></li>
<li class="chapter" data-level="3.5.4" data-path="empirical.html"><a href="empirical.html#empirical-ROC-constrained"><i class="fa fa-check"></i><b>3.5.4</b> The observed end-point of the ROC and its constrained property</a></li>
<li class="chapter" data-level="3.5.5" data-path="empirical.html"><a href="empirical.html#empirical-roc-plot-illustration"><i class="fa fa-check"></i><b>3.5.5</b> Illustration with a dataset</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="empirical.html"><a href="empirical.html#empirical-AFROC"><i class="fa fa-check"></i><b>3.6</b> The alternative FROC (AFROC) plot</a><ul>
<li class="chapter" data-level="3.6.1" data-path="empirical.html"><a href="empirical.html#empirical-definition-empirical-auc-afroc"><i class="fa fa-check"></i><b>3.6.1</b> Definition: empirical AFROC plot and AUC</a></li>
<li class="chapter" data-level="3.6.2" data-path="empirical.html"><a href="empirical.html#empirical-AFROC-constrained"><i class="fa fa-check"></i><b>3.6.2</b> The observed end-point of the AFROC and its constrained property</a></li>
<li class="chapter" data-level="3.6.3" data-path="empirical.html"><a href="empirical.html#empirical-afroc-plot-illustration"><i class="fa fa-check"></i><b>3.6.3</b> Illustration with a dataset</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="empirical.html"><a href="empirical.html#empirical-wAFROC"><i class="fa fa-check"></i><b>3.7</b> The weighted-AFROC plot (wAFROC) plot</a><ul>
<li class="chapter" data-level="3.7.1" data-path="empirical.html"><a href="empirical.html#empirical-definition-empirical-auc-wafroc"><i class="fa fa-check"></i><b>3.7.1</b> The empirical wAFROC plot and AUC</a></li>
<li class="chapter" data-level="3.7.2" data-path="empirical.html"><a href="empirical.html#empirical-wafroc-plot-illustration"><i class="fa fa-check"></i><b>3.7.2</b> Illustration with a dataset</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="empirical.html"><a href="empirical.html#empirical-numerical-understanding"><i class="fa fa-check"></i><b>3.8</b> AFROC vs. wAFROC</a><ul>
<li class="chapter" data-level="3.8.1" data-path="empirical.html"><a href="empirical.html#nl-and-ll-z-samples"><i class="fa fa-check"></i><b>3.8.1</b> NL and LL z-samples</a></li>
<li class="chapter" data-level="3.8.2" data-path="empirical.html"><a href="empirical.html#lesion-weights"><i class="fa fa-check"></i><b>3.8.2</b> Lesion weights</a></li>
<li class="chapter" data-level="3.8.3" data-path="empirical.html"><a href="empirical.html#fpf"><i class="fa fa-check"></i><b>3.8.3</b> FPF</a></li>
<li class="chapter" data-level="3.8.4" data-path="empirical.html"><a href="empirical.html#llf"><i class="fa fa-check"></i><b>3.8.4</b> LLF</a></li>
<li class="chapter" data-level="3.8.5" data-path="empirical.html"><a href="empirical.html#wllf"><i class="fa fa-check"></i><b>3.8.5</b> wLLF</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="empirical.html"><a href="empirical.html#empirical-meanings"><i class="fa fa-check"></i><b>3.9</b> Interpretation of AUCs</a></li>
<li class="chapter" data-level="3.10" data-path="empirical.html"><a href="empirical.html#empirical-instructive-cases"><i class="fa fa-check"></i><b>3.10</b> Instructive examples</a><ul>
<li class="chapter" data-level="3.10.1" data-path="empirical.html"><a href="empirical.html#empirical-instructive-cases-FROC"><i class="fa fa-check"></i><b>3.10.1</b> The FROC</a></li>
<li class="chapter" data-level="3.10.2" data-path="empirical.html"><a href="empirical.html#empirical-instructive-cases-ROC"><i class="fa fa-check"></i><b>3.10.2</b> The ROC</a></li>
<li class="chapter" data-level="3.10.3" data-path="empirical.html"><a href="empirical.html#empirical-instructive-cases-AFROC"><i class="fa fa-check"></i><b>3.10.3</b> The AFROC</a></li>
<li class="chapter" data-level="3.10.4" data-path="empirical.html"><a href="empirical.html#empirical-instructive-cases-wAFROC"><i class="fa fa-check"></i><b>3.10.4</b> The wAFROC</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="empirical.html"><a href="empirical.html#empirical-froc-auc-poor"><i class="fa fa-check"></i><b>3.11</b> FROC-AUC is a poor measure</a><ul>
<li class="chapter" data-level="3.11.1" data-path="empirical.html"><a href="empirical.html#plot-of-froc-auc-vs.-roc-auc"><i class="fa fa-check"></i><b>3.11.1</b> Plot of FROC AUC vs. ROC AUC</a></li>
<li class="chapter" data-level="3.11.2" data-path="empirical.html"><a href="empirical.html#plot-of-afroc-auc-vs.-roc-auc"><i class="fa fa-check"></i><b>3.11.2</b> Plot of AFROC AUC vs. ROC AUC</a></li>
<li class="chapter" data-level="3.11.3" data-path="empirical.html"><a href="empirical.html#plot-of-wafroc-auc-vs.-roc-auc"><i class="fa fa-check"></i><b>3.11.3</b> Plot of wAFROC AUC vs. ROC AUC</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="empirical.html"><a href="empirical.html#empirical-AFROC1"><i class="fa fa-check"></i><b>3.12</b> The AFROC1 plot</a><ul>
<li class="chapter" data-level="3.12.1" data-path="empirical.html"><a href="empirical.html#empirical-definition-empirical-auc-afroc1"><i class="fa fa-check"></i><b>3.12.1</b> Empirical AFROC1 plot and AUC</a></li>
<li class="chapter" data-level="3.12.2" data-path="empirical.html"><a href="empirical.html#empirical-afroc1-plot-illustration"><i class="fa fa-check"></i><b>3.12.2</b> Illustration with a dataset</a></li>
</ul></li>
<li class="chapter" data-level="3.13" data-path="empirical.html"><a href="empirical.html#empirical-wAFROC1"><i class="fa fa-check"></i><b>3.13</b> The weighted-AFROC1 (wAFROC1) plot</a><ul>
<li class="chapter" data-level="3.13.1" data-path="empirical.html"><a href="empirical.html#empirical-definition-empirical-auc-wafroc1"><i class="fa fa-check"></i><b>3.13.1</b> Empirical wAFROC1 plot and AUC</a></li>
<li class="chapter" data-level="3.13.2" data-path="empirical.html"><a href="empirical.html#empirical-wafroc1-plot-illustration"><i class="fa fa-check"></i><b>3.13.2</b> Illustration with a dataset</a></li>
</ul></li>
<li class="chapter" data-level="3.14" data-path="empirical.html"><a href="empirical.html#empirical-summary"><i class="fa fa-check"></i><b>3.14</b> Summary</a></li>
<li class="chapter" data-level="3.15" data-path="empirical.html"><a href="empirical.html#empirical-theorem-1"><i class="fa fa-check"></i><b>3.15</b> Appendix 1: Proof of formula for wAFROC-AUC</a></li>
<li class="chapter" data-level="3.16" data-path="empirical.html"><a href="empirical.html#empirical-theorem-2"><i class="fa fa-check"></i><b>3.16</b> Appendix 2: Interpretation of area under straight line extension of wAFROC</a></li>
<li class="chapter" data-level="3.17" data-path="empirical.html"><a href="empirical.html#empirical-summary-computational-formulae"><i class="fa fa-check"></i><b>3.17</b> Appendix 3: Summary of computational formulae</a><ul>
<li class="chapter" data-level="3.17.1" data-path="empirical.html"><a href="empirical.html#froc"><i class="fa fa-check"></i><b>3.17.1</b> FROC</a></li>
<li class="chapter" data-level="3.17.2" data-path="empirical.html"><a href="empirical.html#roc"><i class="fa fa-check"></i><b>3.17.2</b> ROC</a></li>
<li class="chapter" data-level="3.17.3" data-path="empirical.html"><a href="empirical.html#afroc"><i class="fa fa-check"></i><b>3.17.3</b> AFROC</a></li>
<li class="chapter" data-level="3.17.4" data-path="empirical.html"><a href="empirical.html#wafroc"><i class="fa fa-check"></i><b>3.17.4</b> wAFROC</a></li>
<li class="chapter" data-level="3.17.5" data-path="empirical.html"><a href="empirical.html#afroc1"><i class="fa fa-check"></i><b>3.17.5</b> AFROC1</a></li>
<li class="chapter" data-level="3.17.6" data-path="empirical.html"><a href="empirical.html#wafroc1"><i class="fa fa-check"></i><b>3.17.6</b> wAFROC1</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>The radiological search model (RSM)</b></span></li>
<li class="chapter" data-level="4" data-path="visual-search.html"><a href="visual-search.html"><i class="fa fa-check"></i><b>4</b> Visual Search</a><ul>
<li class="chapter" data-level="4.1" data-path="visual-search.html"><a href="visual-search.html#visual-search-how-much-finished"><i class="fa fa-check"></i><b>4.1</b> How much finished</a></li>
<li class="chapter" data-level="4.2" data-path="visual-search.html"><a href="visual-search.html#visual-search-intro"><i class="fa fa-check"></i><b>4.2</b> Introduction</a></li>
<li class="chapter" data-level="4.3" data-path="visual-search.html"><a href="visual-search.html#visual-search-grouping-labeling-rois"><i class="fa fa-check"></i><b>4.3</b> Grouping and labeling ROIs</a></li>
<li class="chapter" data-level="4.4" data-path="visual-search.html"><a href="visual-search.html#visual-search-recognition-detection"><i class="fa fa-check"></i><b>4.4</b> Lesion-localization vs. detection</a></li>
<li class="chapter" data-level="4.5" data-path="visual-search.html"><a href="visual-search.html#visual-search-search-classification"><i class="fa fa-check"></i><b>4.5</b> Lesion-localization vs. lesion-classification</a></li>
<li class="chapter" data-level="4.6" data-path="visual-search.html"><a href="visual-search.html#visual-search-kundel-nodine-model"><i class="fa fa-check"></i><b>4.6</b> The Kundel - Nodine search model</a><ul>
<li class="chapter" data-level="4.6.1" data-path="visual-search.html"><a href="visual-search.html#visual-search-glancing-global-impression"><i class="fa fa-check"></i><b>4.6.1</b> Lesion-localization</a></li>
<li class="chapter" data-level="4.6.2" data-path="visual-search.html"><a href="visual-search.html#visual-search-scanning-local-feature-analysis"><i class="fa fa-check"></i><b>4.6.2</b> Lesion-classification</a></li>
<li class="chapter" data-level="4.6.3" data-path="visual-search.html"><a href="visual-search.html#visual-search-example"><i class="fa fa-check"></i><b>4.6.3</b> Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="rsm.html"><a href="rsm.html"><i class="fa fa-check"></i><b>5</b> The radiological search model (RSM)</a><ul>
<li class="chapter" data-level="5.1" data-path="rsm.html"><a href="rsm.html#rsm-how-much-finished"><i class="fa fa-check"></i><b>5.1</b> How much finished</a></li>
<li class="chapter" data-level="5.2" data-path="rsm.html"><a href="rsm.html#rsm-intro"><i class="fa fa-check"></i><b>5.2</b> Introduction</a></li>
<li class="chapter" data-level="5.3" data-path="rsm.html"><a href="rsm.html#rsm-details"><i class="fa fa-check"></i><b>5.3</b> The radiological search model</a></li>
<li class="chapter" data-level="5.4" data-path="rsm.html"><a href="rsm.html#rsm-assumptions"><i class="fa fa-check"></i><b>5.4</b> RSM assumptions</a></li>
<li class="chapter" data-level="5.5" data-path="rsm.html"><a href="rsm.html#rsm-parameter-physical-meanings"><i class="fa fa-check"></i><b>5.5</b> Physical meanings of the RSM parameters</a><ul>
<li class="chapter" data-level="5.5.1" data-path="rsm.html"><a href="rsm.html#rsm-mu-parameter"><i class="fa fa-check"></i><b>5.5.1</b> The <span class="math inline">\(\mu\)</span> parameter</a></li>
<li class="chapter" data-level="5.5.2" data-path="rsm.html"><a href="rsm.html#rsm-summary-lambda-parameter"><i class="fa fa-check"></i><b>5.5.2</b> The <span class="math inline">\(\lambda\)</span> parameter</a></li>
<li class="chapter" data-level="5.5.3" data-path="rsm.html"><a href="rsm.html#rsm-summary-nu-parameter"><i class="fa fa-check"></i><b>5.5.3</b> The <span class="math inline">\(\nu\)</span> parameter</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="rsm.html"><a href="rsm.html#rsm-intrinsic-parameters"><i class="fa fa-check"></i><b>5.6</b> Intrinsic RSM parameters</a></li>
<li class="chapter" data-level="5.7" data-path="rsm.html"><a href="rsm.html#rsm-discussion-summary"><i class="fa fa-check"></i><b>5.7</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="rsm-predictions.html"><a href="rsm-predictions.html"><i class="fa fa-check"></i><b>6</b> ROC predictions of the RSM</a><ul>
<li class="chapter" data-level="6.1" data-path="rsm-predictions.html"><a href="rsm-predictions.html#rsm-predictions-how-much-finished"><i class="fa fa-check"></i><b>6.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="6.2" data-path="rsm-predictions.html"><a href="rsm-predictions.html#rsm-predictions-intro"><i class="fa fa-check"></i><b>6.2</b> TBA Introduction</a></li>
<li class="chapter" data-level="6.3" data-path="rsm-predictions.html"><a href="rsm-predictions.html#rsm-predictions-inferred-roc"><i class="fa fa-check"></i><b>6.3</b> Inferred ROC z-sample</a></li>
<li class="chapter" data-level="6.4" data-path="rsm-predictions.html"><a href="rsm-predictions.html#rsm-predictions-end-point"><i class="fa fa-check"></i><b>6.4</b> End-point of the ROC</a><ul>
<li class="chapter" data-level="6.4.1" data-path="rsm-predictions.html"><a href="rsm-predictions.html#rsm-predictions-constrained-end-point-abscissa"><i class="fa fa-check"></i><b>6.4.1</b> The abscissa of the ROC end-point</a></li>
<li class="chapter" data-level="6.4.2" data-path="rsm-predictions.html"><a href="rsm-predictions.html#rsm-predictions-constrained-end-point-ordinate"><i class="fa fa-check"></i><b>6.4.2</b> The ordinate of the ROC end-point</a></li>
<li class="chapter" data-level="6.4.3" data-path="rsm-predictions.html"><a href="rsm-predictions.html#rsm-predictions-end-point-variable-number-lesions"><i class="fa fa-check"></i><b>6.4.3</b> Variable number of lesions per case</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="rsm-predictions.html"><a href="rsm-predictions.html#rsm-predictions-roc-curve"><i class="fa fa-check"></i><b>6.5</b> ROC curve</a><ul>
<li class="chapter" data-level="6.5.1" data-path="rsm-predictions.html"><a href="rsm-predictions.html#rsm-predictions-roc-curve-fpf"><i class="fa fa-check"></i><b>6.5.1</b> Derivation of FPF</a></li>
<li class="chapter" data-level="6.5.2" data-path="rsm-predictions.html"><a href="rsm-predictions.html#rsm-predictions-roc-curve-tpf"><i class="fa fa-check"></i><b>6.5.2</b> Derivation of TPF</a></li>
<li class="chapter" data-level="6.5.3" data-path="rsm-predictions.html"><a href="rsm-predictions.html#rsm-predictions-tpf-varying-lesions"><i class="fa fa-check"></i><b>6.5.3</b> Variable number of lesions per case</a></li>
<li class="chapter" data-level="6.5.4" data-path="rsm-predictions.html"><a href="rsm-predictions.html#rsm-predictions-roc-curve-pdfs"><i class="fa fa-check"></i><b>6.5.4</b> ROC decision variable pdfs</a></li>
<li class="chapter" data-level="6.5.5" data-path="rsm-predictions.html"><a href="rsm-predictions.html#rsm-predictions-roc-curve-auc"><i class="fa fa-check"></i><b>6.5.5</b> ROC AUC</a></li>
<li class="chapter" data-level="6.5.6" data-path="rsm-predictions.html"><a href="rsm-predictions.html#comparing-tpf-formula-to-rjafroc-functions"><i class="fa fa-check"></i><b>6.5.6</b> Comparing TPF formula to <code>RJafroc</code> functions</a></li>
<li class="chapter" data-level="6.5.7" data-path="rsm-predictions.html"><a href="rsm-predictions.html#effect-on-operating-point-of-varying-rsm-parameters"><i class="fa fa-check"></i><b>6.5.7</b> Effect on operating point of varying RSM parameters</a></li>
<li class="chapter" data-level="6.5.8" data-path="rsm-predictions.html"><a href="rsm-predictions.html#rsm-predictions-roc-curves"><i class="fa fa-check"></i><b>6.5.8</b> Sample ROC curves</a></li>
<li class="chapter" data-level="6.5.9" data-path="rsm-predictions.html"><a href="rsm-predictions.html#rsm-predictions-pdf-curves"><i class="fa fa-check"></i><b>6.5.9</b> Sample RSM pdf curves</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="rsm-predictions.html"><a href="rsm-predictions.html#rsm-predictions-roc-curve-proper"><i class="fa fa-check"></i><b>6.6</b> Proper ROC curve</a></li>
<li class="chapter" data-level="6.7" data-path="rsm-predictions.html"><a href="rsm-predictions.html#rsm-predictions-roc-curve-aucs-zeta1"><i class="fa fa-check"></i><b>6.7</b> <span class="math inline">\(\zeta\)</span> dependence of ROC AUC</a></li>
<li class="chapter" data-level="6.8" data-path="rsm-predictions.html"><a href="rsm-predictions.html#rsm-predictions-discussion-summary"><i class="fa fa-check"></i><b>6.8</b> TBA Discussion / Summary</a></li>
<li class="chapter" data-level="6.9" data-path="rsm-predictions.html"><a href="rsm-predictions.html#rsm-predictions-appendix1"><i class="fa fa-check"></i><b>6.9</b> Appendix 1: Proof of continuity of slope at the end-point</a></li>
<li class="chapter" data-level="6.10" data-path="rsm-predictions.html"><a href="rsm-predictions.html#rsm-predictions-appendix2"><i class="fa fa-check"></i><b>6.10</b> Appendix 2: Numerical illustration of continuity</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="rsm-other-predictions.html"><a href="rsm-other-predictions.html"><i class="fa fa-check"></i><b>7</b> Other RSM predictions</a><ul>
<li class="chapter" data-level="7.1" data-path="rsm-other-predictions.html"><a href="rsm-other-predictions.html#rsm-other-predictions-how-much-finished"><i class="fa fa-check"></i><b>7.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="7.2" data-path="rsm-other-predictions.html"><a href="rsm-other-predictions.html#rsm-other-predictions-intro"><i class="fa fa-check"></i><b>7.2</b> TBA Introduction</a></li>
<li class="chapter" data-level="7.3" data-path="rsm-other-predictions.html"><a href="rsm-other-predictions.html#rsm-other-predictions-froc-curve"><i class="fa fa-check"></i><b>7.3</b> RSM-predicted FROC curve</a><ul>
<li class="chapter" data-level="7.3.1" data-path="rsm-other-predictions.html"><a href="rsm-other-predictions.html#froc-plots-lambda_i-nu_i-parameterization"><i class="fa fa-check"></i><b>7.3.1</b> FROC plots <span class="math inline">\(\lambda_i, \nu_i\)</span> parameterization</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="rsm-other-predictions.html"><a href="rsm-other-predictions.html#rsm-other-predictions-froc-afroc-curve"><i class="fa fa-check"></i><b>7.4</b> RSM-predicted AFROC curve</a><ul>
<li class="chapter" data-level="7.4.1" data-path="rsm-other-predictions.html"><a href="rsm-other-predictions.html#afroc-plots-lambda_i-nu_i-parameterization"><i class="fa fa-check"></i><b>7.4.1</b> AFROC plots <span class="math inline">\(\lambda_i, \nu_i\)</span> parameterization</a></li>
<li class="chapter" data-level="7.4.2" data-path="rsm-other-predictions.html"><a href="rsm-other-predictions.html#rsm-other-predictions-no-marks"><i class="fa fa-check"></i><b>7.4.2</b> Case of the reader who does not make any marks</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="rsm-other-predictions.html"><a href="rsm-other-predictions.html#rsm-other-predictions-wafroc-curve"><i class="fa fa-check"></i><b>7.5</b> RSM-predicted wAFROC curve</a><ul>
<li class="chapter" data-level="7.5.1" data-path="rsm-other-predictions.html"><a href="rsm-other-predictions.html#wafroc-plots-lambda_i-nu_i-parameterization"><i class="fa fa-check"></i><b>7.5.1</b> wAFROC plots <span class="math inline">\(\lambda_i, \nu_i\)</span> parameterization</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="rsm-other-predictions.html"><a href="rsm-other-predictions.html#rsm-other-predictions-comments"><i class="fa fa-check"></i><b>7.6</b> Comments on end-point-discontinuity property</a></li>
<li class="chapter" data-level="7.7" data-path="rsm-other-predictions.html"><a href="rsm-other-predictions.html#rsm-other-predictions-appendix"><i class="fa fa-check"></i><b>7.7</b> Appendix</a><ul>
<li class="chapter" data-level="7.7.1" data-path="rsm-other-predictions.html"><a href="rsm-other-predictions.html#rsm-other-predictions-froc-physical-parameters"><i class="fa fa-check"></i><b>7.7.1</b> Slope of the FROC curve</a></li>
<li class="chapter" data-level="7.7.2" data-path="rsm-other-predictions.html"><a href="rsm-other-predictions.html#froc-plots-lambda-nu-parameterization"><i class="fa fa-check"></i><b>7.7.2</b> FROC plots <span class="math inline">\(\lambda, \nu\)</span> parameterization</a></li>
<li class="chapter" data-level="7.7.3" data-path="rsm-other-predictions.html"><a href="rsm-other-predictions.html#rsm-other-predictions-afroc-physical-parameters"><i class="fa fa-check"></i><b>7.7.3</b> Slope of the AFROC curve</a></li>
<li class="chapter" data-level="7.7.4" data-path="rsm-other-predictions.html"><a href="rsm-other-predictions.html#rsm-other-predictions-wafroc-physical-parameters"><i class="fa fa-check"></i><b>7.7.4</b> wAFROC plots <span class="math inline">\(\lambda, \nu\)</span> parameterization</a></li>
<li class="chapter" data-level="7.7.5" data-path="rsm-other-predictions.html"><a href="rsm-other-predictions.html#rsm-other-predictions-roc-above-afroc"><i class="fa fa-check"></i><b>7.7.5</b> ROC curves are above AFROC curves</a></li>
<li class="chapter" data-level="7.7.6" data-path="rsm-other-predictions.html"><a href="rsm-other-predictions.html#rsm-other-predictions-wafroc-above-afroc"><i class="fa fa-check"></i><b>7.7.6</b> Are wAFROC curves above AFROC curves?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="rsm-search-classification.html"><a href="rsm-search-classification.html"><i class="fa fa-check"></i><b>8</b> Lesion localization and classification performances</a><ul>
<li class="chapter" data-level="8.1" data-path="rsm-search-classification.html"><a href="rsm-search-classification.html#rsm-search-classification-how-much-finished"><i class="fa fa-check"></i><b>8.1</b> How much finished</a></li>
<li class="chapter" data-level="8.2" data-path="rsm-search-classification.html"><a href="rsm-search-classification.html#rsm-search-classification-intro"><i class="fa fa-check"></i><b>8.2</b> Introduction</a></li>
<li class="chapter" data-level="8.3" data-path="rsm-search-classification.html"><a href="rsm-search-classification.html#rsm-search-classification-quantifying"><i class="fa fa-check"></i><b>8.3</b> Quantifying lesion-localization performance</a></li>
<li class="chapter" data-level="8.4" data-path="rsm-search-classification.html"><a href="rsm-search-classification.html#rsm-search-classification-performance"><i class="fa fa-check"></i><b>8.4</b> Quantifying lesion-classification performance</a></li>
<li class="chapter" data-level="8.5" data-path="rsm-search-classification.html"><a href="rsm-search-classification.html#rsm-search-classification-discussion"><i class="fa fa-check"></i><b>8.5</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="rsm-fitting.html"><a href="rsm-fitting.html"><i class="fa fa-check"></i><b>9</b> RSM fitting</a><ul>
<li class="chapter" data-level="9.1" data-path="rsm-fitting.html"><a href="rsm-fitting.html#rsm-fitting-how-much-finished"><i class="fa fa-check"></i><b>9.1</b> How much finished</a></li>
<li class="chapter" data-level="9.2" data-path="rsm-fitting.html"><a href="rsm-fitting.html#rsm-fitting-intro"><i class="fa fa-check"></i><b>9.2</b> TBA Introduction</a></li>
<li class="chapter" data-level="9.3" data-path="rsm-fitting.html"><a href="rsm-fitting.html#rsm-fitting-roc-likelihood"><i class="fa fa-check"></i><b>9.3</b> ROC Likelihood function</a></li>
<li class="chapter" data-level="9.4" data-path="rsm-fitting.html"><a href="rsm-fitting.html#rsm-fitting-fitrsmroc-implementation"><i class="fa fa-check"></i><b>9.4</b> Implementation</a></li>
<li class="chapter" data-level="9.5" data-path="rsm-fitting.html"><a href="rsm-fitting.html#rsm-fitting-fitrsmroc-usage-example"><i class="fa fa-check"></i><b>9.5</b> <code>FitRsmROC</code> usage example</a></li>
<li class="chapter" data-level="9.6" data-path="rsm-fitting.html"><a href="rsm-fitting.html#rsm-fitting-discussion-summary"><i class="fa fa-check"></i><b>9.6</b> Discussion / Summary</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="rsm-3-fits.html"><a href="rsm-3-fits.html"><i class="fa fa-check"></i><b>10</b> Three proper ROC fits</a><ul>
<li class="chapter" data-level="10.1" data-path="rsm-3-fits.html"><a href="rsm-3-fits.html#rsm-3-fits-how-much-finished"><i class="fa fa-check"></i><b>10.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="10.2" data-path="rsm-3-fits.html"><a href="rsm-3-fits.html#rsm-3-fits-intro"><i class="fa fa-check"></i><b>10.2</b> TBA Introduction</a></li>
<li class="chapter" data-level="10.3" data-path="rsm-3-fits.html"><a href="rsm-3-fits.html#rsm-3-fits-applications"><i class="fa fa-check"></i><b>10.3</b> Application to datasets</a></li>
<li class="chapter" data-level="10.4" data-path="rsm-3-fits.html"><a href="rsm-3-fits.html#rsm-3-fits-composite-plots"><i class="fa fa-check"></i><b>10.4</b> Composite plots</a></li>
<li class="chapter" data-level="10.5" data-path="rsm-3-fits.html"><a href="rsm-3-fits.html#rsm-3-fits-rsm-parameters"><i class="fa fa-check"></i><b>10.5</b> RSM parameters</a><ul>
<li class="chapter" data-level="10.5.1" data-path="rsm-3-fits.html"><a href="rsm-3-fits.html#rsm-parameters-van-dyke-dataset-i-1-j-2"><i class="fa fa-check"></i><b>10.5.1</b> RSM parameters Van Dyke dataset i = 1, j= 2</a></li>
<li class="chapter" data-level="10.5.2" data-path="rsm-3-fits.html"><a href="rsm-3-fits.html#rsm-parameters-franken-dataset-i-2-j-3"><i class="fa fa-check"></i><b>10.5.2</b> RSM parameters Franken dataset i = 2, j= 3</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="rsm-3-fits.html"><a href="rsm-3-fits.html#rsm-3-fits-cbm-parameters"><i class="fa fa-check"></i><b>10.6</b> CBM parameters</a></li>
<li class="chapter" data-level="10.7" data-path="rsm-3-fits.html"><a href="rsm-3-fits.html#rsm-3-fits-proproc-parameters"><i class="fa fa-check"></i><b>10.7</b> PROPROC parameters</a></li>
<li class="chapter" data-level="10.8" data-path="rsm-3-fits.html"><a href="rsm-3-fits.html#rsm-3-fits-overview"><i class="fa fa-check"></i><b>10.8</b> Overview of findings</a><ul>
<li class="chapter" data-level="10.8.1" data-path="rsm-3-fits.html"><a href="rsm-3-fits.html#rsm-3-fits-slopes"><i class="fa fa-check"></i><b>10.8.1</b> Slopes</a></li>
<li class="chapter" data-level="10.8.2" data-path="rsm-3-fits.html"><a href="rsm-3-fits.html#rsm-3-fits-confidence-intervals"><i class="fa fa-check"></i><b>10.8.2</b> Confidence intervals</a></li>
<li class="chapter" data-level="10.8.3" data-path="rsm-3-fits.html"><a href="rsm-3-fits.html#rsm-3-fits-slopes-confidence-intervals-summary"><i class="fa fa-check"></i><b>10.8.3</b> Summary of slopes and confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="rsm-3-fits.html"><a href="rsm-3-fits.html#rsm-3-fits-discussion-summary"><i class="fa fa-check"></i><b>10.9</b> Reason for equal AUCs / Summary</a></li>
<li class="chapter" data-level="10.10" data-path="rsm-3-fits.html"><a href="rsm-3-fits.html#rsm-3-fits-appendices"><i class="fa fa-check"></i><b>10.10</b> Appendices</a><ul>
<li class="chapter" data-level="10.10.1" data-path="rsm-3-fits.html"><a href="rsm-3-fits.html#rsm-3-fits-one-dataset-proproc"><i class="fa fa-check"></i><b>10.10.1</b> Location of PROPROC files</a></li>
<li class="chapter" data-level="10.10.2" data-path="rsm-3-fits.html"><a href="rsm-3-fits.html#rsm-3-fits-pre-analyzed-results"><i class="fa fa-check"></i><b>10.10.2</b> Location of pre-analyzed results</a></li>
<li class="chapter" data-level="10.10.3" data-path="rsm-3-fits.html"><a href="rsm-3-fits.html#rsm-3-fits-representative-plots-van-dyke"><i class="fa fa-check"></i><b>10.10.3</b> Plots for the Van Dyke dataset</a></li>
<li class="chapter" data-level="10.10.4" data-path="rsm-3-fits.html"><a href="rsm-3-fits.html#rsm-3-fits-representative-plots-franken"><i class="fa fa-check"></i><b>10.10.4</b> Plots for the Franken dataset</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>CAD applications</b></span></li>
<li class="chapter" data-level="11" data-path="standalone-cad-radiologists.html"><a href="standalone-cad-radiologists.html"><i class="fa fa-check"></i><b>11</b> Standalone CAD</a><ul>
<li class="chapter" data-level="11.1" data-path="standalone-cad-radiologists.html"><a href="standalone-cad-radiologists.html#standalone-cad-radiologists-how-much-finished"><i class="fa fa-check"></i><b>11.1</b> How much finished</a></li>
<li class="chapter" data-level="11.2" data-path="standalone-cad-radiologists.html"><a href="standalone-cad-radiologists.html#standalone-cad-radiologists-introduction"><i class="fa fa-check"></i><b>11.2</b> Introduction</a></li>
<li class="chapter" data-level="11.3" data-path="standalone-cad-radiologists.html"><a href="standalone-cad-radiologists.html#standalone-cad-radiologists-overview"><i class="fa fa-check"></i><b>11.3</b> Overview</a></li>
<li class="chapter" data-level="11.4" data-path="standalone-cad-radiologists.html"><a href="standalone-cad-radiologists.html#standalone-cad-radiologists-methods"><i class="fa fa-check"></i><b>11.4</b> Methods</a><ul>
<li class="chapter" data-level="11.4.1" data-path="standalone-cad-radiologists.html"><a href="standalone-cad-radiologists.html#standalone-cad-radiologists-two-previous-studies"><i class="fa fa-check"></i><b>11.4.1</b> Studies assessing performance of CAD vs. radiologists</a></li>
<li class="chapter" data-level="11.4.2" data-path="standalone-cad-radiologists.html"><a href="standalone-cad-radiologists.html#the-1t-rrfc-analysis-model"><i class="fa fa-check"></i><b>11.4.2</b> The 1T-RRFC analysis model</a></li>
<li class="chapter" data-level="11.4.3" data-path="standalone-cad-radiologists.html"><a href="standalone-cad-radiologists.html#standalone-cad-radiologists-2TRRRC-anlaysis"><i class="fa fa-check"></i><b>11.4.3</b> The 2T-RRRC analysis model</a></li>
<li class="chapter" data-level="11.4.4" data-path="standalone-cad-radiologists.html"><a href="standalone-cad-radiologists.html#standalone-cad-radiologists-1TRRRC-anlaysis"><i class="fa fa-check"></i><b>11.4.4</b> The 1T-RRRC analysis model</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="standalone-cad-radiologists.html"><a href="standalone-cad-radiologists.html#standalone-cad-radiologists-computational-details"><i class="fa fa-check"></i><b>11.5</b> Implementation</a></li>
<li class="chapter" data-level="11.6" data-path="standalone-cad-radiologists.html"><a href="standalone-cad-radiologists.html#standalone-cad-radiologists-results"><i class="fa fa-check"></i><b>11.6</b> Results</a></li>
<li class="chapter" data-level="11.7" data-path="standalone-cad-radiologists.html"><a href="standalone-cad-radiologists.html#standalone-cad-radiologists-discussion"><i class="fa fa-check"></i><b>11.7</b> Discussion</a></li>
<li class="chapter" data-level="11.8" data-path="standalone-cad-radiologists.html"><a href="standalone-cad-radiologists.html#standalone-cad-radiologists-appendix1"><i class="fa fa-check"></i><b>11.8</b> Appendix 1</a><ul>
<li class="chapter" data-level="11.8.1" data-path="standalone-cad-radiologists.html"><a href="standalone-cad-radiologists.html#example-1"><i class="fa fa-check"></i><b>11.8.1</b> Example 1</a></li>
<li class="chapter" data-level="11.8.2" data-path="standalone-cad-radiologists.html"><a href="standalone-cad-radiologists.html#example-2"><i class="fa fa-check"></i><b>11.8.2</b> Example 2</a></li>
<li class="chapter" data-level="11.8.3" data-path="standalone-cad-radiologists.html"><a href="standalone-cad-radiologists.html#example-3"><i class="fa fa-check"></i><b>11.8.3</b> Example 3</a></li>
</ul></li>
<li class="chapter" data-level="11.9" data-path="standalone-cad-radiologists.html"><a href="standalone-cad-radiologists.html#standalone-cad-radiologists-appendix2"><i class="fa fa-check"></i><b>11.9</b> Appendix 2</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="optim-op-point.html"><a href="optim-op-point.html"><i class="fa fa-check"></i><b>12</b> CAD optimal operating point</a><ul>
<li class="chapter" data-level="12.1" data-path="optim-op-point.html"><a href="optim-op-point.html#optim-op-point-how-much-finished"><i class="fa fa-check"></i><b>12.1</b> TBA How much finished</a></li>
<li class="chapter" data-level="12.2" data-path="optim-op-point.html"><a href="optim-op-point.html#optim-op-point-intro"><i class="fa fa-check"></i><b>12.2</b> Introduction</a></li>
<li class="chapter" data-level="12.3" data-path="optim-op-point.html"><a href="optim-op-point.html#optim-op-point-methods"><i class="fa fa-check"></i><b>12.3</b> Methods</a></li>
<li class="chapter" data-level="12.4" data-path="optim-op-point.html"><a href="optim-op-point.html#optim-op-point-vary-lambda"><i class="fa fa-check"></i><b>12.4</b> Varying <span class="math inline">\(\lambda\)</span> optimizations</a><ul>
<li class="chapter" data-level="12.4.1" data-path="optim-op-point.html"><a href="optim-op-point.html#summary-table"><i class="fa fa-check"></i><b>12.4.1</b> Summary table</a></li>
<li class="chapter" data-level="12.4.2" data-path="optim-op-point.html"><a href="optim-op-point.html#froc-1"><i class="fa fa-check"></i><b>12.4.2</b> FROC</a></li>
<li class="chapter" data-level="12.4.3" data-path="optim-op-point.html"><a href="optim-op-point.html#wafroc-1"><i class="fa fa-check"></i><b>12.4.3</b> wAFROC</a></li>
<li class="chapter" data-level="12.4.4" data-path="optim-op-point.html"><a href="optim-op-point.html#roc-1"><i class="fa fa-check"></i><b>12.4.4</b> ROC</a></li>
<li class="chapter" data-level="12.4.5" data-path="optim-op-point.html"><a href="optim-op-point.html#why-not-maximize-roc-auc"><i class="fa fa-check"></i><b>12.4.5</b> Why not maximize ROC-AUC?</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="optim-op-point.html"><a href="optim-op-point.html#optim-op-point-vary-nu-mu"><i class="fa fa-check"></i><b>12.5</b> Varying <span class="math inline">\(\nu\)</span> and <span class="math inline">\(\mu\)</span> optimizations</a></li>
<li class="chapter" data-level="12.6" data-path="optim-op-point.html"><a href="optim-op-point.html#optim-op-point-vary-nu-limiting-situations"><i class="fa fa-check"></i><b>12.6</b> Limiting situations</a></li>
<li class="chapter" data-level="12.7" data-path="optim-op-point.html"><a href="optim-op-point.html#optim-op-point-trends"><i class="fa fa-check"></i><b>12.7</b> Trends</a></li>
<li class="chapter" data-level="12.8" data-path="optim-op-point.html"><a href="optim-op-point.html#optim-op-point-how-to-use-method"><i class="fa fa-check"></i><b>12.8</b> Applying the method</a><ul>
<li class="chapter" data-level="12.8.1" data-path="optim-op-point.html"><a href="optim-op-point.html#optim-op-point-application"><i class="fa fa-check"></i><b>12.8.1</b> A CAD application</a></li>
<li class="chapter" data-level="12.8.2" data-path="optim-op-point.html"><a href="optim-op-point.html#optim-op-point-application1"><i class="fa fa-check"></i><b>12.8.2</b> TBA Handling diseased-only datasets</a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="optim-op-point.html"><a href="optim-op-point.html#optim-op-point-discussion"><i class="fa fa-check"></i><b>12.9</b> TBA Discussion</a></li>
<li class="chapter" data-level="12.10" data-path="optim-op-point.html"><a href="optim-op-point.html#cad-optim-op-appendices"><i class="fa fa-check"></i><b>12.10</b> Appendices</a><ul>
<li class="chapter" data-level="12.10.1" data-path="optim-op-point.html"><a href="optim-op-point.html#optim-op-point-vary-nu"><i class="fa fa-check"></i><b>12.10.1</b> Varying <span class="math inline">\(\nu\)</span> optimizations</a></li>
<li class="chapter" data-level="12.10.2" data-path="optim-op-point.html"><a href="optim-op-point.html#optim-op-point-vary-mu"><i class="fa fa-check"></i><b>12.10.2</b> Varying <span class="math inline">\(\mu\)</span> optimizations</a></li>
<li class="chapter" data-level="12.10.3" data-path="optim-op-point.html"><a href="optim-op-point.html#optim-op-point-limiting-situations"><i class="fa fa-check"></i><b>12.10.3</b> Limiting cases</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>DATASETS</b></span></li>
<li class="chapter" data-level="13" data-path="datasets.html"><a href="datasets.html"><i class="fa fa-check"></i><b>13</b> Datasets</a><ul>
<li class="chapter" data-level="13.1" data-path="datasets.html"><a href="datasets.html#datasets-datasets"><i class="fa fa-check"></i><b>13.1</b> Datasets</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>REFERENCES</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The RJafroc Froc Book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="empirical" class="section level1 hasAnchor">
<h1><span class="header-section-number">Chapter 3</span> Empirical plots from FROC data<a href="empirical.html#empirical" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="empirical-how-much-finished" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.1</span> How much finished<a href="empirical.html#empirical-how-much-finished" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>100%</p>
</div>
<div id="empirical-intro" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.2</span> Introduction<a href="empirical.html#empirical-intro" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>FROC data consists of mark-rating pairs. A distinction is made between <em>latent</em> marks (suspicious regions perceived by the visual system but not necessarily marked) and <em>actual</em> marks. A key table (used in later chapters) summarizing FROC notation is introduced which allows unambiguous description of the data.</p>
<p>Empirical plots refer to those generated directly from the data. Empirical operating characteristics (empirical plots) introduced in this chapter are the FROC, the (inferred) ROC, the alternative FROC (AFROC), the weighted AFROC (wAFROC), the AFROC1, wAFROC1. Formulae for x and y coordinates of each plot are given in terms of the underlying mark-rating FROC data.</p>
<p>Plots are <em>visual</em> depictions of performance. Scalar measures derived from plots can serve as <em>quantitative</em> measures of performance. Empirical area under curve (AUC) measures associated with all plots are illustrated with a small FROC dataset. Except for the FROC plot all of the other plots include a straight line extension from the uppermost observed operating point to (1,1).</p>
<p>If one ignores localization information and simply considers the highest rating on each case as representing its ROC rating, one can define the empirical ROC plot and associated area measure ROC-AUC from FROC data. Since ROC-AUC is a fundamental measure of classification accuracy between non-diseased and diseased cases any other proposed area measure that does not ignore location information should, if it is to be useful, correlate with ROC-AUC. These correlations are explored using the small dataset and it is shown that FROC-AUC is a poor measure of performance. While ways of circumventing FROC-AUC have been proposed and have been used by some investigators none are satisfactory and the claim of this book is that <strong>the FROC should never be used to quantify performance</strong>. The basic reason is simple: unlike all of the other plots defined in this chapter the FROC plot is not constrained to lie within the unit square and the area under a straight line extension to (1,1) is meaningless.</p>
<p>Some of the other empirical plots and AUCs are less familiar as compared to the well-known ROC plots and ROC-AUC. As an aid to understanding them I have included numerical (“hand”) calculations of the empirical plots and AUCs for the small dataset. The calculations also illustrate the advantage of using <em>weighted</em> versions implemented in some of the empirical plots (lesion weights are a way of allowing one to model the clinical importance (i.e., morbidity/mortality) associated with different type of lesions present in a clinical dataset; a weighted plot assures that each case gets the same importance in determining AUC regardless of the number of lesions in it).</p>
<p>Computing the AUCs from plots can be tedious at best; computational formulae are needed which would allow any of the AUCs to be calculated directly from the FROC ratings. Appendix 1 proves a formula for the wAFROC-AUC, Appendix 2 provides a physical interpretation of the area under the straight line extension for this plot. Appendix 3 summarizes, without proofs, the computational formulae for AUCs for all plots introduced in this chapter.</p>
</div>
<div id="empirical-mark-rating-pairs" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.3</span> FROC data and notation<a href="empirical.html#empirical-mark-rating-pairs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="lls-vs.-nls" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.3.1</span> LLs vs. NLs<a href="empirical.html#lls-vs.-nls" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Each mark indicates the location of a region suspicious enough to warrant reporting and the rating is the associated confidence level. A mark is recorded as a <em>lesion localization</em> (LL) if it is sufficiently close to a true lesion and otherwise it is recorded as a <em>non-lesion localization</em> (NL).</p>
<p>In an FROC study the number of marks on a case is an a-priori unknown non-negative random integer. It is incorrect and naive to estimate it by dividing the anatomically-relevant image area by the lesion area because not all regions of the image are equally likely to have lesions, lesions do not have the same size, and perhaps most important, radiologists don’t assign equal attention units to all areas of the image.<a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a></p>
</div>
<div id="latent-vs.-actual-marks" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.3.2</span> Latent vs. actual marks<a href="empirical.html#latent-vs.-actual-marks" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To distinguish between suspicious regions that were considered for marking but not necessarily marked and regions that were actually marked, it is necessary to introduce the distinction between <em>latent</em> marks and <em>actual</em> marks.</p>
<ul>
<li>A <em>latent</em> mark is defined as a suspicious region, regardless of whether or not it was marked. A latent mark becomes an <em>actual</em> mark if it is marked.</li>
<li>A latent mark is a latent LL if it is close to a true lesion and otherwise it is a latent NL.</li>
<li>A non-diseased case can only have latent NLs. A diseased case can have latent NLs and latent LLs.</li>
<li>If marked a latent NL is recorded as an actual NL.</li>
<li>If not marked a latent NL is an <em>unobservable event</em>. This is an important point.</li>
<li>In contrast unmarked lesions are observable events – one knows (trivially) which lesions were not marked.</li>
</ul>
</div>
<div id="z-samples-vs.-ratings" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.3.3</span> z-samples vs. ratings<a href="empirical.html#z-samples-vs.-ratings" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>z-samples are conceptual quantities that can range from <span class="math inline">\(-\infty\)</span> to <span class="math inline">\(+\infty\)</span>. Ratings are observed values typically collected as integers but any ordered set of values will do where larger values correspond to greater suspicion for disease. The conversion from z-samples to ratings is accomplished by adopting a binning rule.</p>
</div>
<div id="binning-rule" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.3.4</span> Binning rule<a href="empirical.html#binning-rule" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Recall that ROC data modeling requires the existence of a <em>case-dependent</em> decision variable, or z-sample <span class="math inline">\(z\)</span>, and case-independent decision thresholds <span class="math inline">\(\zeta_r\)</span>, where <span class="math inline">\(r = 0, 1, ..., R_{ROC}-1\)</span>, where <span class="math inline">\(R_{ROC}\)</span> is the number of ROC study bins<a href="#fn15" class="footnote-ref" id="fnref15"><sup>15</sup></a> and a <em>binning rule</em> that if <span class="math inline">\(\zeta_r \leq z &lt; \zeta_{r+1}\)</span> the case is rated <span class="math inline">\(r + 1\)</span>. Dummy cutoffs are defined as <span class="math inline">\(\zeta_0 = -\infty\)</span> and <span class="math inline">\(\zeta_{R_{ROC}} = \infty\)</span>. The z-sample applies to the whole case. To summarize:</p>
<p><span class="math display" id="eq:binning-rule-roc">\[\begin{equation}
\left.
\begin{aligned}  
\text{if} \left (\zeta_r \le z &lt; \zeta_{r+1}  \right )\Rightarrow \text {rating} = r+1\\
r = 0, 1, ..., R_{ROC}-1\\
\zeta_0 = -\infty\\
\zeta_{R_{ROC}} = \infty\\
\end{aligned}
\right \}
\tag{3.1}
\end{equation}\]</span></p>
<p>Analogously, FROC data modeling requires the existence of a <em>case and location dependent</em> z-sample for each latent mark and <em>case and location independent</em> reporting thresholds <span class="math inline">\(\zeta_r\)</span>, where <span class="math inline">\(r = 1, ..., R_{FROC}\)</span> and <span class="math inline">\(R_{FROC}\)</span> is the number of FROC study bins, and the binning rule that a latent mark is marked and rated <span class="math inline">\(r\)</span> if <span class="math inline">\(\zeta_r \leq z &lt; \zeta_{r+1}\)</span>. Dummy cutoffs are defined as <span class="math inline">\(\zeta_0 = -\infty\)</span> and <span class="math inline">\(\zeta_{R_{FROC}+1} = \infty\)</span>. For the same numbers of non-dummy cutoffs, the number of FROC bins is one less than the number of ROC bins. For example, 4 non-dummy cutoffs <span class="math inline">\(\zeta_1, \zeta_2, \zeta_3, \zeta_4\)</span> can correspond to a 5-rating ROC study or to a 4-rating FROC study. To summarize:</p>
<p><span class="math display" id="eq:binning-rule-froc">\[\begin{equation}
\left.
\begin{aligned}  
\text{if} \left (\zeta_r \le z &lt; \zeta_{r+1}  \right )\Rightarrow \text {rating} = r\\
r = 1, 2, ..., R_{FROC}\\
\zeta_0 = -\infty\\
\zeta_{R_{FROC}+1} = \infty\\
\end{aligned}
\right \}
\tag{3.2}
\end{equation}\]</span></p>
</div>
<div id="empirical-notation" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.3.5</span> Notation<a href="empirical.html#empirical-notation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>Clear notation is vital to understanding this paradigm.</em> The notation needs to account for case and location dependencies of ratings and the distinction between case-level and location-level ground truths. <em>The notation also has to account for cases with no marks.</em></p>
<p>FROC notation is summarized in Table <a href="empirical.html#tab:empirical-notation">3.1</a> in which <em>marks refer to latent marks</em>. The first column is the row number, the second column has the symbol(s), and the third column has the meaning(s) of the symbol(s).</p>
<table>
<caption>
<span id="tab:empirical-notation">TABLE 3.1: </span>FROC notation; all marks refer to latent marks.
</caption>
<thead>
<tr>
<th style="text-align:left;">
Row
</th>
<th style="text-align:left;">
Symbol
</th>
<th style="text-align:left;">
Meaning
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
<span class="math inline">\(t\)</span>
</td>
<td style="text-align:left;">
Case-level truth: 1 non-diseased, 2 diseased case
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
<span class="math inline">\(K_t\)</span>
</td>
<td style="text-align:left;">
Number of cases with case-level truth <span class="math inline">\(t\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
<span class="math inline">\(k_t t\)</span>
</td>
<td style="text-align:left;">
Case <span class="math inline">\(k_t\)</span> in case-level truth <span class="math inline">\(t\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
<span class="math inline">\(s\)</span>
</td>
<td style="text-align:left;">
Location-level truth: 1 for NL and 2 for LL
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
<span class="math inline">\(l_s s\)</span>
</td>
<td style="text-align:left;">
Mark <span class="math inline">\(l_s\)</span> in location-level truth <span class="math inline">\(s\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
<span class="math inline">\(N_{k_t t}\)</span>
</td>
<td style="text-align:left;">
Number of NLs in case <span class="math inline">\(k_t t\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
<span class="math inline">\(L_{k_2 2}\)</span>
</td>
<td style="text-align:left;">
Number of lesions in case <span class="math inline">\(k_2 2\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
<span class="math inline">\(z_{k_t t l_1 1}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(z\)</span>-sample for case <span class="math inline">\(k_t t\)</span> and NL mark <span class="math inline">\(l_1 1\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
<span class="math inline">\(z_{k_2 2 l_2 2}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(z\)</span>-sample for case <span class="math inline">\(k_2 2\)</span> and LL mark <span class="math inline">\(l_2 2\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
<span class="math inline">\(r_{k_t t l_s s}\)</span>
</td>
<td style="text-align:left;">
rating for case <span class="math inline">\(k_t t\)</span> and LL/NL mark <span class="math inline">\(l_s s\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
<span class="math inline">\(R_{FROC}\)</span>
</td>
<td style="text-align:left;">
Number of FROC bins
</td>
</tr>
<tr>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
<span class="math inline">\(\zeta_1\)</span>
</td>
<td style="text-align:left;">
Lowest non-dummy reporting threshold
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
<span class="math inline">\(\zeta_r\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(r\)</span> = 2, 3, …, non-dummy reporting thresholds
</td>
</tr>
<tr>
<td style="text-align:left;">
14
</td>
<td style="text-align:left;">
<span class="math inline">\(\zeta_0, \zeta_{R_{FROC}+1}\)</span>
</td>
<td style="text-align:left;">
Dummy thresholds, negative and positive infinity
</td>
</tr>
<tr>
<td style="text-align:left;">
15
</td>
<td style="text-align:left;">
<span class="math inline">\(W_{k_2 l_2}\)</span>
</td>
<td style="text-align:left;">
Weight of lesion <span class="math inline">\(l_2 2\)</span> in case <span class="math inline">\(k_2 2\)</span>, explained later
</td>
</tr>
<tr>
<td style="text-align:left;">
16
</td>
<td style="text-align:left;">
<span class="math inline">\(L_{max}\)</span>
</td>
<td style="text-align:left;">
Maximum number of lesions per case in dataset
</td>
</tr>
<tr>
<td style="text-align:left;">
17
</td>
<td style="text-align:left;">
<span class="math inline">\(L_T\)</span>
</td>
<td style="text-align:left;">
Total number of lesions in dataset
</td>
</tr>
</tbody>
</table>
</div>
<div id="comments" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.3.6</span> Comments<a href="empirical.html#comments" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Row 1: The case-truth index <span class="math inline">\(t\)</span> refers to the case (or patient), with <span class="math inline">\(t = 1\)</span> for non-diseased and <span class="math inline">\(t = 2\)</span> for diseased cases. As a useful mnemonic, <span class="math inline">\(t\)</span> is for <em>truth</em>.</p></li>
<li><p>Row 2: <span class="math inline">\(K_t\)</span> is the number of cases with truth state <span class="math inline">\(t\)</span>; specifically, <span class="math inline">\(K_1\)</span> is the number of non-diseased cases and <span class="math inline">\(K_2\)</span> the number of diseased cases.</p></li>
<li><p>Row 3: Two indices <span class="math inline">\(k_t t\)</span> are needed to select case <span class="math inline">\(k_t\)</span> in truth state <span class="math inline">\(t\)</span>. As a useful mnemonic, <span class="math inline">\(k\)</span> is for <em>case</em>.</p></li>
<li><p>Row 4: <span class="math inline">\(s\)</span> location-level truth state: 1 for non-diseased region (NL) and 2 for lesion (LL).</p></li>
<li><p>Row 5: Similar to row 3, two indices <span class="math inline">\(l_s s\)</span> are needed to select latent mark <span class="math inline">\(l_s\)</span> in location-level truth state <span class="math inline">\(s\)</span>. As a useful mnemonic, <span class="math inline">\(l\)</span> is for <em>location</em>.</p></li>
<li><p>Row 6: <span class="math inline">\(N_{k_t t}\)</span> is the total number of latent NL marks in case <span class="math inline">\(k_t t\)</span>. Latent NL marks are possible on non-diseased and diseased cases (i.e., both values of <span class="math inline">\(t\)</span> are allowed).</p></li>
<li><p>Row 7: <span class="math inline">\(L_{k_2 2}\)</span> is the number of lesions in diseased case <span class="math inline">\(k_2 2\)</span>.</p></li>
<li><p>Row 8: The z-sample for case <span class="math inline">\(k_t t\)</span> and NL mark <span class="math inline">\(l_1 1\)</span> is denoted <span class="math inline">\(z_{k_t t l_1 1}\)</span>. The range of a z-sample is <span class="math inline">\(-\infty &lt; z_{k_t t l_1 1} &lt; \infty\)</span>, provided <span class="math inline">\(l_1 \neq \varnothing\)</span>; otherwise, it is an unobservable event.</p></li>
<li><p>Row 9: The z-sample of a latent LL is <span class="math inline">\(z_{k_2 2 l_2 2}\)</span>. Unmarked lesions are observable events assigned negative infinity ratings (the null-set notation is unnecessary).</p></li>
<li><p>Row 10: The rating of a mark is <span class="math inline">\(r_{k_2 2 l_2 2}\)</span>. Unmarked NLs are unobservable events. Unmarked lesions are assigned negative infinity ratings.</p></li>
<li><p>Row 11: <span class="math inline">\(R_{FROC}\)</span> is the number of bins in the FROC study.</p></li>
<li><p>Rows 12, 13 and 14: The cutoffs in the FROC study. The lowest threshold is <span class="math inline">\(\zeta_1\)</span>. The other non-dummy thresholds are <span class="math inline">\(\zeta_r\)</span> where <span class="math inline">\(r=2,3,...,R_{FROC}\)</span>. The dummy thresholds are <span class="math inline">\(\zeta_0 = -\infty\)</span> and <span class="math inline">\(\zeta_{R_{FROC}+1} = \infty\)</span>.</p></li>
<li><p>Row 15: <span class="math inline">\(W_{k_2 l_2}\)</span> is the weight (i.e., clinical importance) of lesion <span class="math inline">\(l_2 2\)</span> in diseased case <span class="math inline">\(k_2 2\)</span>. The weights of lesions in a case sum to unity: <span class="math inline">\(\sum_{l_2 = 1}^{L_{k_2 2}}W_{k_2 l_2} = 1\)</span>.</p></li>
<li><p>Row 16: <span class="math inline">\(L_{max}\)</span> is the maximum number of lesions per case in the dataset.</p></li>
<li><p>Row 17: <span class="math inline">\(L_T\)</span> is the total number of lesions in the dataset.</p></li>
</ul>
</div>
<div id="empirical-indexing-marks" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.3.7</span> A conceptual and notatonal issue<a href="empirical.html#empirical-indexing-marks" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An aspect of FROC data, <em>that there could be cases with no NL marks, no matter how low the reporting threshold</em>, has created problems both from conceptual and notational viewpoints.</p>
<p>Taking the conceptual issue first, my thinking (prior to 2004) was that as the reporting threshold <span class="math inline">\(\zeta_1\)</span> is lowered, the number of NL marks per case increases almost indefinitely. I visualized this process as each case “filling up” with NL marks.<a href="#fn16" class="footnote-ref" id="fnref16"><sup>16</sup></a> In fact the first model of FROC data <span class="citation">(Chakraborty <a href="#ref-chakraborty1989maximum" role="doc-biblioref">1989</a>)</span> predicts that as the reporting threshold is lowered to <span class="math inline">\(\zeta_1 = -\infty\)</span>, the number of NL marks per case approaches <span class="math inline">\(\infty\)</span>. However, actual FROC datasets do not agree with this thinking. This is one reason I introduced the radiological search model (RSM) <span class="citation">(Dev P Chakraborty <a href="#ref-chakraborty2006search" role="doc-biblioref">2006</a>)</span>. I will have more to say about this in Chapter <a href="rsm.html#rsm">5</a>, but for now I state one assumption of the RSM: the number of latent NL marks is a Poisson distributed random integer with a finite value for the mean parameter of the distribution. This means that the actual number of latent NL marks per case can be 0, 1, 2, .., whose average (over all cases) is a finite number. It is highly unlikely that any case will have an infinite number of NLs.</p>
<p>With this background, let us return to the conceptual issue: why does the observer not keep “filling-up” the image with NL marks? The answer is that <em>the observer can only mark regions that have a non-zero chance of being a lesion</em>. For example, if the actual number of latent NLs on a particular case is 2, then, as the reporting threshold is lowered, the observer will make at most two NL marks. Having exhausted these two regions the observer will not mark any more regions because there are no more regions to be marked - <em>all other regions in the image have, in the perception of the observer, zero chance of being a lesion</em>.</p>
<p>The notational issue is how to handle cases with no latent NL marks. Basically it involves restricting summations over cases to those cases which have at least one latent NL mark, i.e., <span class="math inline">\(N_{k_t t} &gt; 0\)</span>, as in the following:</p>
<ul>
<li><p><span class="math inline">\(l_1 = \{1, 2, ..., N_{k_t t}\}\)</span> indexes latent NL marks, provided the case has at least one latent NL mark; otherwise <span class="math inline">\(N_{k_t t} = 0\)</span> and <span class="math inline">\(l_1 = \varnothing\)</span>, the null set. The possible values of <span class="math inline">\(l_1\)</span> are <span class="math inline">\(l_1 = \left \{ \varnothing \right \}\oplus \left \{ 1,2,...N_{k_t t} \right \}\)</span>. The null set applies when the case has no latent NL marks and <span class="math inline">\(\oplus\)</span> is the “exclusive-or” symbol (“exclusive-or” is used in the English sense: “one or the other, but not neither nor both”).</p></li>
<li><p><span class="math inline">\(l_2 = \left \{ 1,2,...,L_{k_2 2} \right \}\)</span> indexes latent LL marks. Unmarked LLs are assigned negative infinity ratings as these are observable events. The null set notation is not needed because for every diseased case <span class="math inline">\(L_{k_2 2} &gt; 0\)</span>.</p></li>
</ul>
</div>
</div>
<div id="empirical-froc-plot-1" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.4</span> The FROC plot<a href="empirical.html#empirical-froc-plot-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Definitions:</p>
<blockquote>
<ul>
<li><span class="math inline">\(NLF_r \equiv NLF(\zeta_r)\)</span> = cumulated NL counts with z-sample <span class="math inline">\(\geq\)</span> threshold <span class="math inline">\(\zeta_r\)</span> divided by total number of cases.</li>
<li><span class="math inline">\(LLF_r \equiv LLF(\zeta_r)\)</span> = cumulated LL counts with z-sample <span class="math inline">\(\geq\)</span> threshold <span class="math inline">\(\zeta_r\)</span> divided by total number of lesions.</li>
</ul>
</blockquote>
<p>Definitions:</p>
<blockquote>
<p>The empirical FROC plot connects adjacent operating points <span class="math inline">\(\left (\text{NLF}_r, \text{LLF}_r \right )\)</span>, including the origin (0,0) and the observed end-point, with straight lines. The area under this plot is the empirical FROC AUC, denoted <span class="math inline">\(A_{\text{FROC}}\)</span>. <strong>Warning: this is a particularly dangerous figure of merit, as will shortly become clear.</strong></p>
</blockquote>
<p>Using the notation of Table <a href="empirical.html#tab:empirical-notation">3.1</a> and assuming binned data<a href="#fn17" class="footnote-ref" id="fnref17"><sup>17</sup></a> and <span class="math inline">\(n(x)\)</span> denotes the number of events <span class="math inline">\(x\)</span>:</p>
<p><span class="math display" id="eq:empirical-NLF1">\[\begin{equation}
\text{NLF}_r  = \frac{n\left ( \text{NLs rated} \geq \zeta_r\right )}{K_1 + K_2}
\tag{3.3}
\end{equation}\]</span></p>
<p>and</p>
<p><span class="math display" id="eq:empirical-LLF1">\[\begin{equation}
\text{LLF}_r  = \frac{n\left ( \text{LLs rated} \geq \zeta_r\right )}{L_T}
\tag{3.4}
\end{equation}\]</span></p>
<p>The allowed values of <span class="math inline">\(r\)</span> are:</p>
<p><span class="math display" id="eq:empirical-range-r">\[\begin{equation}
r = 1, 2, ...,R_{FROC} 
\tag{3.5}
\end{equation}\]</span></p>
<p>Due to the ordering of the thresholds, i.e., <span class="math inline">\(\zeta_1 &lt; \zeta_2 ... &lt; \zeta_{R_{FROC}}\)</span>, higher values of <span class="math inline">\(r\)</span> correspond to lower operating points. The uppermost operating point, i.e., that defined by <span class="math inline">\(r = 1\)</span>, is referred to the as the <em>observed end-point</em>.</p>
<p>Equations <a href="empirical.html#eq:empirical-NLF1">(3.3)</a> and <a href="empirical.html#eq:empirical-LLF1">(3.4)</a> are equivalent to:</p>
<p><span class="math display" id="eq:empirical-NLFr">\[\begin{equation}
\text{NLF}_r  = \frac{1}{K_1+K_2} \sum_{t=1}^{2} \sum_{k_t=1}^{K_t} \mathbb{I} \left ( N_{k_t t} &gt; 0 \right )\sum_{l_1=1}^{N_{k_t t}} \mathbb{I} \left ( z_{k_t t l_1 1} \geq \zeta_r \right ) 
\tag{3.6}
\end{equation}\]</span></p>
<p>and</p>
<p><span class="math display" id="eq:empirical-LLFr">\[\begin{equation}
\text{LLF}_r  = \frac{1}{L_T} \sum_{k_2=1}^{K_2} \sum_{l_2=1}^{L_{k_2 2}} \mathbb{I} \left ( z_{k_2 2 l_2 2} \geq \zeta_r  \right ) 
\tag{3.7}
\end{equation}\]</span></p>
<p>The indicator function is defined as unity if the argument is true and zero otherwise:</p>
<p><span class="math display" id="eq:empirical-indicator-function">\[\begin{equation}
\left.
\begin{matrix}
\mathbb{I}\left( \text{True} \right) &amp; = &amp;  1\\
\mathbb{I}\left( \text{False} \right) &amp; = &amp; 0 
\end{matrix}
\right \}
\tag{3.8}
\end{equation}\]</span></p>
<p>In Eqn. <a href="empirical.html#eq:empirical-NLFr">(3.6)</a> <span class="math inline">\(\mathbb{I} \left ( N_{k_t t} &gt; 0 \right )\)</span> ensures that <em>only cases with at least one latent NL</em> are included in the summation (recall that <span class="math inline">\(N_{k_t t}\)</span> is the total number of latent NLs in case <span class="math inline">\(k_t t\)</span>). The term <span class="math inline">\(\mathbb{I} \left ( z_{k_t t l_1 1} \geq \zeta_r \right )\)</span> counts over all NL marks with ratings <span class="math inline">\(\geq \zeta_r\)</span>. The right hand side yields the total number of NLs in the dataset with z-samples <span class="math inline">\(\geq \zeta_r\)</span> and dividing by the total number of cases yields <span class="math inline">\(\text{NLF}_r\)</span>. This equation also shows explicitly that NLs on both non-diseased (<span class="math inline">\(t=1\)</span>) and diseased (<span class="math inline">\(t=2\)</span>) cases contribute to NLF.</p>
<p>In Eqn. <a href="empirical.html#eq:empirical-LLFr">(3.7)</a> a summation over <span class="math inline">\(t\)</span> is not needed as only diseased cases contribute to LLF. A term like <span class="math inline">\(\mathbb{I} \left ( L_{k_2 2} &gt; 0 \right )\)</span> would be superfluous since <span class="math inline">\(L_{k_2 2} &gt; 0\)</span> as each diseased case must have at least one lesion. The term <span class="math inline">\(\mathbb{I} \left ( z_{k_2 2 l_2 2} \geq \zeta_r \right )\)</span> counts over all LL marks with ratings <span class="math inline">\(\geq \zeta_r\)</span>. Dividing by <span class="math inline">\(L_T\)</span>, the total number of lesions in the dataset, yields <span class="math inline">\(\text{LLF}_r\)</span>.</p>
<p>Since <span class="math inline">\(\zeta_{R_{FROC}+1} = \infty\)</span> according to Eqn. <a href="empirical.html#eq:empirical-NLFr">(3.6)</a> and Eqn. <a href="empirical.html#eq:empirical-LLFr">(3.7)</a> <span class="math inline">\(r = R_{FROC}+1\)</span> yields the trivial operating point (0,0).</p>
<div id="empirical-end-point" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.1</span> The observed FROC end-point and its semi-constrained property<a href="empirical.html#empirical-end-point" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The abscissa of the observed end-point <span class="math inline">\(NLF_1\)</span>, is defined by:</p>
<p><span class="math display" id="eq:empirical-NLF11">\[\begin{equation}
\text{NLF}_1 = \frac{1}{K_1+K_2} \sum_{t=1}^{2} \sum_{k_t=1}^{K_t} \mathbb{I} \left ( N_{k_t t} &gt; 0 \right ) \sum_{l_1=1}^{N_{k_t t}} \mathbb{I} \left ( z_{k_t t l_1 1} \geq \zeta_1 \right ) 
\tag{3.9}
\end{equation}\]</span></p>
<p>Since each case could have an arbitrary non-negative number of NLs, <span class="math inline">\(NLF_1\)</span> need not equal unity, except fortuitously.</p>
<p>The ordinate of the observed end-point <span class="math inline">\(LLF_1\)</span>, is defined by:</p>
<p><span class="math display" id="eq:empirical-LLF1a">\[\begin{equation}
\left.
\begin{aligned}
\text{LLF}_1 =&amp; \frac{1}{L_T} \sum_{k_2=1}^{K_2} \sum_{l_2=1}^{L_{k_2 2}} \mathbb{I} \left ( z_{k_2 2 l_2 2} \geq  \zeta_1  \right ) \\
\leq&amp; 1
\end{aligned}
\right \}
\tag{3.10}
\end{equation}\]</span></p>
<p>The numerator is the total number of lesions that were actually marked. The ratio is the fraction of lesions that are marked, which is <span class="math inline">\(\leq 1\)</span>.</p>
<p>This is the <strong>semi-constrained property of the observed end-point</strong>, namely, while the <em>ordinate</em> is constrained to the range (0,1) the <em>abscissa</em> is not.</p>
</div>
<div id="empirical-froc-plot-futility-extrapolation" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.2</span> Futility of extrapolation outside the observed end-point<a href="empirical.html#empirical-froc-plot-futility-extrapolation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To understand this consider the expression for <span class="math inline">\(NLF_0\)</span>, i.e., using Eqn. <a href="empirical.html#eq:empirical-NLFr">(3.6)</a> with <span class="math inline">\(r = 0\)</span>:</p>
<p><span class="math display">\[\begin{equation}
\text{NLF}_0 = \frac{1}{K_1+K_2} \sum_{t=1}^{2} \sum_{k_t=1}^{K_t} \mathbb{I} \left ( N_{k_t t} &gt; 0 \right ) \sum_{l_1=1}^{N_{k_t t}} \mathbb{I} \left ( z_{k_t t l_1 1} \geq -\infty \right ) 
\end{equation}\]</span></p>
<p>The right hand side of this equation can be separated into two terms, the contribution of latent NLs with z-samples in the range <span class="math inline">\(z \geq \zeta_1\)</span> and those in the range <span class="math inline">\(-\infty \leq z &lt; \zeta_1\)</span>. The first term yields the abscissa of the observed end-point, Eqn. <a href="empirical.html#eq:empirical-NLF11">(3.9)</a> but the 2nd term cannot be evaluated:</p>
<p><span class="math display" id="eq:empirical-NLF0a">\[\begin{equation}
\left. 
\begin{aligned} 
\text{1st term}=&amp;\left (\frac{1}{K_1+K_2} \right )\sum_{t=1}^{2} \sum_{k_t=1}^{K_t} \mathbb{I} \left ( N_{k_t t} &gt; 0 \right ) \sum_{l_1=1}^{N_{k_t t}} \mathbb{I} \left ( z_{k_t t l_1 1} \ge \zeta_1 \right )\\
=&amp;\text{NLF}_1\\
\text{2nd term}=&amp;\left (\frac{1}{K_1+K_2} \right )\sum_{t=1}^{2} \sum_{k_t=1}^{K_t} \mathbb{I} \left ( N_{k_t t} &gt; 0 \right ) \sum_{l_1=1}^{N_{k_t t}} \mathbb{I} \left ( -\infty \leq z_{k_t t l_1 1} &lt; \zeta_1 \right )\\
=&amp;\frac{\text{unknown number}}{K_1+K_2}
\end{aligned}
\right \} 
\tag{3.11}
\end{equation}\]</span></p>
<p>The 2nd term represents the contribution of <em>unmarked NLs</em>, i.e., latent NLs whose z-samples were below <span class="math inline">\(\zeta_1\)</span>. It determines how much further to the right the observer’s NLF would have moved relative to <span class="math inline">\(NLF_1\)</span> <em>if</em> one could get the observer to lower the reporting criterion to <span class="math inline">\(-\infty\)</span>. <em>Since the observer may not oblige, this term cannot, in general, be evaluated.</em> Therefore <span class="math inline">\(NLF_0\)</span> cannot be evaluated. The basic problem is that <em>unmarked latent NLs represent unobservable events</em>.</p>
<p>Turning our attention to <span class="math inline">\(LLF_0\)</span>:</p>
<p><span class="math display" id="eq:empirical-LLF0">\[\begin{equation}
\left.
\begin{aligned}
\text{LLF}_0 =&amp; \frac{ \sum_{k_2=1}^{K_2} \sum_{l_2=1}^{L_{k_2 2}} \mathbb{I} \left ( z_{k_2 2 l_2 2} \geq  -\infty  \right ) }{L_T}\\
=&amp; 1
\end{aligned}
\right \}
\tag{3.12}
\end{equation}\]</span></p>
<p>Unlike unmarked latent NLs, <em>unmarked lesions can safely be assigned the <span class="math inline">\(-\infty\)</span> rating, because an unmarked lesion is an observable event</em>. The right hand side of Eqn. <a href="empirical.html#eq:empirical-LLF0">(3.12)</a> evaluates to unity. However, since the corresponding abscissa <span class="math inline">\(NLF_0\)</span> is undefined, one cannot plot this point. It follows that one cannot extrapolate outside the observed end-point.</p>
<p>The above formalism should not obscure the fact that the futility of extrapolation outside the observed end-point of the FROC is obvious for scientific reasons: extrapolating outside the range of the observed data is generally not a good idea.</p>
</div>
<div id="empirical-froc-plot-illustration" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.3</span> Illustration with a dataset<a href="empirical.html#empirical-froc-plot-illustration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following plot uses <code>dataset04</code> <span class="citation">(Zanca et al. <a href="#ref-zanca2009evaluation" role="doc-biblioref">2009</a>)</span> to illustrate an empirical FROC plot. This dataset has <span class="math inline">\(L_{max} = 3\)</span>, <span class="math inline">\(\max{(N_{k_tt}})= 3\)</span> and a 5-point rating scale was employed. The following plot applies to reader 1 in modality (treatment) 1 only. The full dataset has 5 modalities and 4 readers.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="empirical.html#cb3-1"></a>ret &lt;-<span class="st"> </span><span class="kw">PlotEmpiricalOperatingCharacteristics</span>(</span>
<span id="cb3-2"><a href="empirical.html#cb3-2"></a>  dataset04, </span>
<span id="cb3-3"><a href="empirical.html#cb3-3"></a>  <span class="dt">trts =</span> <span class="dv">1</span>, <span class="dt">rdrs =</span> <span class="dv">1</span>, <span class="dt">opChType =</span> <span class="st">&quot;FROC&quot;</span>)</span>
<span id="cb3-4"><a href="empirical.html#cb3-4"></a><span class="kw">print</span>(ret<span class="op">$</span>Plot)</span></code></pre></div>
<p><img src="03-empirical_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>Shown next are FROC-AUCs for this dataset calculated using the formula in Eqn. <a href="empirical.html#eq:empirical-computational-froc">(3.43)</a>. All 20 modality-reader combinations are shown.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="empirical.html#cb4-1"></a>auc_froc &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">UtilFigureOfMerit</span>(dataset04, <span class="dt">FOM =</span> <span class="st">&quot;FROC&quot;</span>))</span>
<span id="cb4-2"><a href="empirical.html#cb4-2"></a><span class="kw">print</span>(auc_froc)</span>
<span id="cb4-3"><a href="empirical.html#cb4-3"></a><span class="co">#&gt;           rdr1      rdr3      rdr4       rdr5</span></span>
<span id="cb4-4"><a href="empirical.html#cb4-4"></a><span class="co">#&gt; trt1 0.2361972 0.1085035 0.2268486 0.09922535</span></span>
<span id="cb4-5"><a href="empirical.html#cb4-5"></a><span class="co">#&gt; trt2 0.2192077 0.2231338 0.4793310 0.18450704</span></span>
<span id="cb4-6"><a href="empirical.html#cb4-6"></a><span class="co">#&gt; trt3 0.1947359 0.1063028 0.2543662 0.15137324</span></span>
<span id="cb4-7"><a href="empirical.html#cb4-7"></a><span class="co">#&gt; trt4 0.2198768 0.1307394 0.3293662 0.13882042</span></span>
<span id="cb4-8"><a href="empirical.html#cb4-8"></a><span class="co">#&gt; trt5 0.1800528 0.1097535 0.3015141 0.16563380</span></span></code></pre></div>
<p>The value 0.2361972 for <code>trt1</code> and <code>rdr1</code> is the area under the FROC plot shown above.</p>
</div>
</div>
<div id="empirical-ROC" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.5</span> The inferred-ROC plot<a href="empirical.html#empirical-ROC" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>By adopting a rule for converting the mark-rating data per case to a single rating per case, and commonly the highest rating rule is used,<a href="#fn18" class="footnote-ref" id="fnref18"><sup>18</sup></a> it is possible to infer ROC data from FROC mark-rating data.</p>
<div id="empirical-ROC-fpf" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.5.1</span> The inferred-ROC z-sample<a href="empirical.html#empirical-ROC-fpf" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The highest ROC z-sample of a case, denoted <span class="math inline">\(h_{k_t t}\)</span>, is the z-sample of the highest rated latent mark on the case or <span class="math inline">\(-\infty\)</span> if the case has no latent marks. For non-diseased cases <span class="math inline">\(t = 1\)</span> the maximum is over all latent NLs on the case. For diseased cases <span class="math inline">\(t = 2\)</span> the maximum is over all latent NLs <em>and</em> latent LLs on the case.</p>
<p>When there is little possibility for confusion, the prefix “inferred” is suppressed. ROC z-samples on non-diseased cases are referred to as FP z-samples and those on diseased cases as TP z-samples.</p>
<p>Using the by now familiar cumulation procedure, FP counts are cumulated to calculate FPF and likewise TP counts are cumulated to calculate TPF.</p>
<p>Definitions:</p>
<ul>
<li><span class="math inline">\(FPF(\zeta)\)</span> = cumulated inferred FP counts with <span class="math inline">\(h_{k_1 1} \geq \zeta\)</span> divided by total number of non-diseased cases.</li>
<li><span class="math inline">\(TPF(\zeta)\)</span> = cumulated inferred TP counts with <span class="math inline">\(h_{k_2 2} \geq \zeta\)</span> divided by total number of diseased cases.</li>
</ul>
<p>Definition of ROC plot:</p>
<blockquote>
<ul>
<li>The ROC is the plot of inferred <span class="math inline">\(TPF(\zeta)\)</span> vs. inferred <span class="math inline">\(FPF(\zeta)\)</span>.</li>
<li><em>The plot includes a straight line extension from the observed end-point to (1,1)</em>.</li>
</ul>
</blockquote>
<p>The highest z-sample ROC false positive (FP) z-sample for non-diseased case <span class="math inline">\(k_1 1\)</span> is defined by:</p>
<p><span class="math display" id="eq:empirical-FP">\[\begin{equation}
\left.
\begin{aligned}
\begin{matrix}
FP_{k_1 1}=&amp;\max_{l_1} \left ( z_{k_1 1 l_1 1 } \right ) &amp; \text{if} &amp; l_1 \neq \varnothing\\
FP_{k_1 1}=&amp;-\infty &amp; \text{if} &amp; l_1 = \varnothing
\end{matrix}
\end{aligned}
\right \}
\tag{3.13}
\end{equation}\]</span></p>
<p>If the case has at least one latent NL mark, then <span class="math inline">\(l_1 \neq \varnothing\)</span>, where <span class="math inline">\(\varnothing\)</span> is the null set, and the first definition applies. If the case has no latent NL marks, then <span class="math inline">\(l_1 = \varnothing\)</span>, and the second definition applies. <span class="math inline">\(FP_{k_1 1}\)</span> is the maximum z-sample over all latent marks occurring on non-diseased case <span class="math inline">\(k_1 1\)</span>, or <span class="math inline">\(-\infty\)</span> if the case has no latent marks (this is allowed because a non-diseased case with no marks is an observable event). The corresponding false positive fraction is defined by:</p>
<p><span class="math display" id="eq:empirical-fpf">\[\begin{equation}
\text{FPF}_r \equiv \text{FPF} \left ( \zeta_r \right ) = \frac{1}{K_1} \sum_{k_1=1}^{K_1} \mathbb{I} \left ( FP_{k_1 1} \geq \zeta_r\right )
\tag{3.14}
\end{equation}\]</span></p>
</div>
<div id="empirical-ROC-tpf" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.5.2</span> Inferred TPF<a href="empirical.html#empirical-ROC-tpf" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The inferred true positive (TP) z-sample for diseased case <span class="math inline">\(k_2 2\)</span> is defined by one of the following three equations, as explained below:</p>
<p><span class="math display" id="eq:empirical-TP1">\[\begin{equation}
\begin{matrix}
TP_{k_2 2} = \max_{l_1 l_2}\left ( z_{k_2 2 l_1 1} ,z_{k_2 2 l_2 2}  \right ) &amp; \text{if} &amp; l_1 \neq \varnothing
\end{matrix}
\tag{3.15}
\end{equation}\]</span></p>
<p>or</p>
<p><span class="math display" id="eq:empirical-TP2">\[\begin{equation}
\begin{matrix}
TP_{k_2 2} = \max_{l_2}  \left ( z_{k_2 2 l_2 2} \right ) 
 &amp; \text{if} &amp; \left( l_1 = \varnothing \right) \land \left (\max_{l_2}{\left (z_{k_2 2 l_2 2}  \right )} &gt; -\infty  \right )
\end{matrix}
\tag{3.16}
\end{equation}\]</span></p>
<p>or</p>
<p><span class="math display" id="eq:empirical-TP3">\[\begin{equation}
\begin{matrix}
TP_{k_2 2} = -\infty 
 &amp; \text{if} &amp; \left ( l_1 = \varnothing \land\left ( \max_{l_2}{\left (z_{k_2 2 l_2 2}  \right )} = -\infty  \right )  \right )
\end{matrix}
\tag{3.17}
\end{equation}\]</span></p>
<p>Here <span class="math inline">\(\land\)</span> is the logical AND operator. An explanation is in order. Consider Eqn. <a href="empirical.html#eq:empirical-TP1">(3.15)</a>. There are two z-samples inside the <span class="math inline">\(\max\)</span> operator: <span class="math inline">\(z_{k_2 2 l_1 1} ,z_{k_2 2 l_2 2}\)</span>. The first z-sample is from a NL on a diseased case, as per the <span class="math inline">\(l_1 1\)</span> subscripts, while the second is from a LL on the same diseased case, as per the <span class="math inline">\(l_2 2\)</span> subscripts.</p>
<ul>
<li><p>If <span class="math inline">\(l_1 \neq \varnothing\)</span> then Eqn. <a href="empirical.html#eq:empirical-TP1">(3.15)</a> applies, i.e., one takes the maximum over all z-samples, NLs and LLs, whichever is higher, on the diseased case.</p></li>
<li><p>If <span class="math inline">\(l_1 = \varnothing\)</span> and at least one lesion is marked, then Eqn. <a href="empirical.html#eq:empirical-TP2">(3.16)</a> applies, i.e., one takes the maximum z-sample over all marked LLs.</p></li>
<li><p>If <span class="math inline">\(l_1 = \varnothing\)</span> and no lesions are marked, then Eqn. <a href="empirical.html#eq:empirical-TP3">(3.17)</a> applies; this represents an unmarked diseased case; the <span class="math inline">\(-\infty\)</span> z-sample assignment is justified because an unmarked diseased case is an observable event.</p></li>
</ul>
<p>The inferred true positive fraction <span class="math inline">\(\text{TPF}_r\)</span> is defined by:</p>
<p><span class="math display" id="eq:empirical-TPF">\[\begin{equation}
\text{TPF}_r \equiv \text{TPF}(\zeta_r) = \frac{1}{K_2}\sum_{k_2=1}^{K_2} \mathbb{I}\left ( TP_{k_2 2} \geq \zeta_r \right )
\tag{3.18}
\end{equation}\]</span></p>
</div>
<div id="empirical-definition-empirical-auc-roc" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.5.3</span> The empirical ROC plot and AUC<a href="empirical.html#empirical-definition-empirical-auc-roc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Definitions:</p>
<blockquote>
<p>The inferred empirical ROC plot connects adjacent points <span class="math inline">\(\left( \text{FPF}_r, \text{TPF}_r \right )\)</span>, including the origin (0,0), with straight lines plus a straight-line segment connecting the observed end-point to (1,1). Like a real ROC, this plot is constrained to lie within the unit square. The area under this plot is the empirical inferred ROC AUC, denoted <span class="math inline">\(A_{\text{ROC}}\)</span>.</p>
</blockquote>
</div>
<div id="empirical-ROC-constrained" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.5.4</span> The observed end-point of the ROC and its constrained property<a href="empirical.html#empirical-ROC-constrained" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The abscissa of the observed end-point <span class="math inline">\(FPF_1\)</span>, is defined by:</p>
<p><span class="math display" id="eq:empirical-fpf-repeat">\[\begin{equation}
\text{FPF}_1 \equiv \text{FPF} \left ( \zeta_1 \right ) = \frac{1}{K_1} \sum_{k_1=1}^{K_1} \mathbb{I} \left ( FP_{k_1 1} \geq \zeta_1 \right )
\tag{3.19}
\end{equation}\]</span></p>
<p>Since each case gets a single FP z-sample, and only unmarked cases get the <span class="math inline">\(-\infty\)</span> z-sample, <span class="math inline">\(\text{FPF}_1 \leq 1\)</span>.</p>
<p>The ordinate of the observed end-point <span class="math inline">\(TPF_1\)</span>, is defined by:</p>
<p><span class="math display" id="eq:empirical-TPF-repeat">\[\begin{equation}
\text{TPF}_1 \equiv \text{TPF}(\zeta_1) = \frac{1}{K_2}\sum_{k_2=1}^{K_2} \mathbb{I}\left ( TP_{k_2 2} \geq \zeta_1 \right )
\tag{3.20}
\end{equation}\]</span></p>
<p>Since each case gets a single TP z-sample, and only unmarked cases get the <span class="math inline">\(-\infty\)</span> z-sample, <span class="math inline">\(\text{TPF}_1 \leq 1\)</span>.</p>
<p>It follows that the observed end-point of the ROC (as is well known) satisfies the constrained end-point property: it lies below-left the (1,1) corner of the plot.</p>
<blockquote>
<p>The upper-right corner (reached by counting all z-samples <span class="math inline">\(\ge -\infty\)</span>) of the ROC plot is not to be confused by the observed end-point (reached by counting all z-samples <span class="math inline">\(\ge \zeta_1\)</span>).</p>
</blockquote>
</div>
<div id="empirical-roc-plot-illustration" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.5.5</span> Illustration with a dataset<a href="empirical.html#empirical-roc-plot-illustration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following code uses <code>dataset04</code> to illustrate an empirical ROC plot for treatment 1 and reader 1. The reader should experiment by running <code>PlotEmpiricalOperatingCharacteristics(dataset04, trts = 1, rdrs = 1, opChType = ROC")$Plot</code> with different treatments <code>trts</code> and readers <code>rdrs</code> specified.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="empirical.html#cb5-1"></a>ret &lt;-<span class="st"> </span><span class="kw">PlotEmpiricalOperatingCharacteristics</span>(</span>
<span id="cb5-2"><a href="empirical.html#cb5-2"></a>  dataset04, </span>
<span id="cb5-3"><a href="empirical.html#cb5-3"></a>  <span class="dt">trts =</span> <span class="dv">1</span>, <span class="dt">rdrs =</span> <span class="dv">1</span>, <span class="dt">opChType =</span> <span class="st">&quot;ROC&quot;</span>)</span>
<span id="cb5-4"><a href="empirical.html#cb5-4"></a><span class="kw">print</span>(ret<span class="op">$</span>Plot)</span></code></pre></div>
<p><img src="03-empirical_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Shown next is calculation of the figure of merit for this dataset. Note that in function <code>UtilFigureOfMerit()</code> the <code>FOM</code> argument has to be set to <code>HrAuc</code>, for highest rating AUC.].</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="empirical.html#cb6-1"></a><span class="kw">UtilFigureOfMerit</span>(dataset04, <span class="dt">FOM =</span> <span class="st">&quot;HrAuc&quot;</span>)</span>
<span id="cb6-2"><a href="empirical.html#cb6-2"></a><span class="co">#&gt;         rdr1    rdr3    rdr4    rdr5</span></span>
<span id="cb6-3"><a href="empirical.html#cb6-3"></a><span class="co">#&gt; trt1 0.90425 0.79820 0.81175 0.86645</span></span>
<span id="cb6-4"><a href="empirical.html#cb6-4"></a><span class="co">#&gt; trt2 0.86425 0.84470 0.82050 0.87160</span></span>
<span id="cb6-5"><a href="empirical.html#cb6-5"></a><span class="co">#&gt; trt3 0.81295 0.81635 0.75275 0.85730</span></span>
<span id="cb6-6"><a href="empirical.html#cb6-6"></a><span class="co">#&gt; trt4 0.90235 0.83150 0.78865 0.87980</span></span>
<span id="cb6-7"><a href="empirical.html#cb6-7"></a><span class="co">#&gt; trt5 0.84140 0.77300 0.77115 0.84800</span></span></code></pre></div>
</div>
</div>
<div id="empirical-AFROC" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.6</span> The alternative FROC (AFROC) plot<a href="empirical.html#empirical-AFROC" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Fig. 4 in <span class="citation">(Bunch et al. <a href="#ref-bunch1977free" role="doc-biblioref">1977</a>)</span> anticipated another way of visualizing FROC data. I subsequently termed this the <em>alternative FROC (AFROC)</em> plot <span class="citation">(Chakraborty <a href="#ref-chakraborty1989maximum" role="doc-biblioref">1989</a>)</span>.</li>
<li>The empirical AFROC is defined as the plot of <span class="math inline">\(\text{LLF}(\zeta_r)\)</span> along the ordinate vs. <span class="math inline">\(\text{FPF}(\zeta_r)\)</span> along the abscissa.</li>
<li><span class="math inline">\(\text{LLF}_r \equiv \text{LLF}(\zeta_r)\)</span>, the ordinate of the FROC plot, was defined in Eqn. <a href="empirical.html#eq:empirical-LLFr">(3.7)</a>.</li>
<li><span class="math inline">\(\text{FPF}_r \equiv \text{FPF}(\zeta_r)\)</span>, the abscissa of the ROC plot, was defined in Eqn. <a href="empirical.html#eq:empirical-fpf">(3.14)</a>.</li>
</ul>
<div id="empirical-definition-empirical-auc-afroc" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.6.1</span> Definition: empirical AFROC plot and AUC<a href="empirical.html#empirical-definition-empirical-auc-afroc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The empirical AFROC plot connects adjacent operating points <span class="math inline">\(\left( \text{FPF}_r, \text{LLF}_r \right )\)</span>, including the origin (0,0) and (1,1), with straight lines. The area under this plot is the empirical AFROC AUC, denoted <span class="math inline">\(A_{\text{AFROC}}\)</span>.</p>
<p>Key points:</p>
<ul>
<li>The ordinates (LLF) of the FROC and AFROC are identical.</li>
<li>The abscissa (FPF) of the ROC and AFROC are identical.</li>
<li>The AFROC is a hybrid plot incorporating aspects of both ROC and FROC plots.</li>
<li>The AFROC is constrained to within the unit square.</li>
</ul>
<blockquote>
<p>Prof. Richard Swensson did not like my choice of the word “alternative” in naming this operating characteristic. I had no idea in 1989 how important this plot would later turn out to be, otherwise a more meaningful name might have been proposed. To anticipate the central message of this book, the AUC based on this plot (and weighted versions of it introduced below), are superior to the FROC-AUC and the ROC-AUC in terms of statistical power and reliability (the FROC-AUC is especially unreliable).</p>
</blockquote>
</div>
<div id="empirical-AFROC-constrained" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.6.2</span> The observed end-point of the AFROC and its constrained property<a href="empirical.html#empirical-AFROC-constrained" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>According to Eqn. <a href="empirical.html#eq:empirical-fpf">(3.14)</a> the abscissa of the observed end-point <span class="math inline">\(FPF_1 \leq 1\)</span> and according to Eqn. <a href="empirical.html#eq:empirical-LLF1a">(3.10)</a> the ordinate of the observed end-point <span class="math inline">\(\text{LLF}_1 \leq 1\)</span>. It follows that the observed end-point of the AFROC satisfies the constrained end-point property, i.e., it lies below-left the (1,1) corner of the plot.</p>
</div>
<div id="empirical-afroc-plot-illustration" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.6.3</span> Illustration with a dataset<a href="empirical.html#empirical-afroc-plot-illustration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following code uses <code>dataset04</code> to illustrate an empirical AFROC plot for treatment 1 and reader 1.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="empirical.html#cb7-1"></a>ret &lt;-<span class="st"> </span><span class="kw">PlotEmpiricalOperatingCharacteristics</span>(</span>
<span id="cb7-2"><a href="empirical.html#cb7-2"></a>  dataset04, </span>
<span id="cb7-3"><a href="empirical.html#cb7-3"></a>  <span class="dt">trts =</span> <span class="dv">1</span>, <span class="dt">rdrs =</span> <span class="dv">1</span>, <span class="dt">opChType =</span> <span class="st">&quot;AFROC&quot;</span>)</span>
<span id="cb7-4"><a href="empirical.html#cb7-4"></a><span class="kw">print</span>(ret<span class="op">$</span>Plot)</span></code></pre></div>
<p><img src="03-empirical_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Shown next are the figures of merit for this dataset for all treatment reader combinations.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="empirical.html#cb8-1"></a><span class="kw">UtilFigureOfMerit</span>(dataset04, <span class="dt">FOM =</span> <span class="st">&quot;AFROC&quot;</span>)</span>
<span id="cb8-2"><a href="empirical.html#cb8-2"></a><span class="co">#&gt;           rdr1      rdr3      rdr4      rdr5</span></span>
<span id="cb8-3"><a href="empirical.html#cb8-3"></a><span class="co">#&gt; trt1 0.7427113 0.7104930 0.7003169 0.7909859</span></span>
<span id="cb8-4"><a href="empirical.html#cb8-4"></a><span class="co">#&gt; trt2 0.7586972 0.7161620 0.7225352 0.7927465</span></span>
<span id="cb8-5"><a href="empirical.html#cb8-5"></a><span class="co">#&gt; trt3 0.6983451 0.6955282 0.6777817 0.7547535</span></span>
<span id="cb8-6"><a href="empirical.html#cb8-6"></a><span class="co">#&gt; trt4 0.7817606 0.7234507 0.7132746 0.8136268</span></span>
<span id="cb8-7"><a href="empirical.html#cb8-7"></a><span class="co">#&gt; trt5 0.7169718 0.6690845 0.6587324 0.7682042</span></span></code></pre></div>
</div>
</div>
<div id="empirical-wAFROC" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.7</span> The weighted-AFROC plot (wAFROC) plot<a href="empirical.html#empirical-wAFROC" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The AFROC ordinate defined in Eqn. <a href="empirical.html#eq:empirical-LLFr">(3.7)</a> gives equal importance to every lesion in a case. A case with more lesions will have more influence on the AFROC (see next section for an explicit demonstration of this fact). This is undesirable since each case (i.e., patient) should get equal importance in the analysis – as with ROC analysis, one wishes to draw conclusions about the population of cases and each case is an equally valid sample from the population. In particular, one does not want the analysis to be skewed towards cases with greater numbers of lesions.<a href="#fn19" class="footnote-ref" id="fnref19"><sup>19</sup></a></p>
<p>Another issue is that the AFROC assigns equal <em>clinical</em> importance to each lesion in a case. Lesion weights were introduced <span class="citation">(Chakraborty and Berbaum <a href="#ref-RN1385" role="doc-biblioref">2004</a>)</span> to allow for the possibility that the clinical importance of finding a lesion might be lesion-dependent <span class="citation">(Chakraborty and Yoon <a href="#ref-RN1966" role="doc-biblioref">2009</a>)</span>. For example, it is possible that a diseased cases has lesions of two types with differing clinical importance; the figure-of-merit should give more credit to finding the more clinically important one. Clinical importance could be defined as the mortality associated with the specific lesion type; these can be obtained from epidemiological studies <span class="citation">(DeSantis et al. <a href="#ref-desantis2011breast" role="doc-biblioref">2011</a>)</span>.</p>
<p>Let <span class="math inline">\(W_{k_2 l_2} \geq 0\)</span> denote the <em>weight</em> (i.e., short for clinical importance) of lesion <span class="math inline">\(l_2\)</span> in diseased case <span class="math inline">\(k_2\)</span> (since weights are only applicable to diseased cases one can, without ambiguity, drop the case-level and location-level truth subscripts, i.e., the notation <span class="math inline">\(W_{k_2 2 l_2 2}\)</span> would be superfluous). For each diseased case <span class="math inline">\(k_2 2\)</span> the weights are subject to the constraint:</p>
<p><span class="math display" id="eq:empirical-weights-constraint">\[\begin{equation}
\sum_{l_2 =1 }^{L_{k_2 2}} W_{k_2 l_2} = 1
\tag{3.21}
\end{equation}\]</span></p>
<p>The weighted lesion localization fraction <span class="math inline">\(\text{wLLF}_r\)</span> is defined by <span class="citation">(Chakraborty and Zhai <a href="#ref-RN2484" role="doc-biblioref">2016</a>)</span>:</p>
<p><span class="math display" id="eq:empirical-wLLFr">\[\begin{equation}
\text{wLLF}_r \equiv \text{wLLF}\left ( \zeta_r \right ) = \frac{1}{K_2}\sum_{k_2=1}^{K_2}\sum_{l_2=1}^{L_{k_2 2}}W_{k_2 l_2} \mathbb{I}\left ( z_{k_2 2 l_2 2} \geq \zeta_r \right )
\tag{3.22}
\end{equation}\]</span></p>
<div id="empirical-definition-empirical-auc-wafroc" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.7.1</span> The empirical wAFROC plot and AUC<a href="empirical.html#empirical-definition-empirical-auc-wafroc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>The empirical wAFROC plot connects adjacent operating points <span class="math inline">\(\left ( \text{FPF}_r, \text{wLLF}_r \right )\)</span>, including the origin (0,0), with straight lines plus a straight-line segment connecting the observed end-point to (1,1). The area under this plot is the empirical weighted-AFROC AUC, denoted <span class="math inline">\(A_{\text{wAFROC}}\)</span>.</p>
</blockquote>
</div>
<div id="empirical-wafroc-plot-illustration" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.7.2</span> Illustration with a dataset<a href="empirical.html#empirical-wafroc-plot-illustration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following code uses <code>dataset04</code> to illustrate an empirical ROC plot for treatment 1 and reader 1.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="empirical.html#cb9-1"></a>ret &lt;-<span class="st"> </span><span class="kw">PlotEmpiricalOperatingCharacteristics</span>(</span>
<span id="cb9-2"><a href="empirical.html#cb9-2"></a>  dataset04, <span class="dt">trts =</span> <span class="dv">1</span>, <span class="dt">rdrs =</span> <span class="dv">1</span>, <span class="dt">opChType =</span> <span class="st">&quot;wAFROC&quot;</span>)</span>
<span id="cb9-3"><a href="empirical.html#cb9-3"></a><span class="kw">print</span>(ret<span class="op">$</span>Plot)</span></code></pre></div>
<p><img src="03-empirical_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>Shown next is calculation of the figure of merit for this dataset.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="empirical.html#cb10-1"></a><span class="kw">UtilFigureOfMerit</span>(dataset04, <span class="dt">FOM =</span> <span class="st">&quot;wAFROC&quot;</span>)</span>
<span id="cb10-2"><a href="empirical.html#cb10-2"></a><span class="co">#&gt;           rdr1      rdr3      rdr4      rdr5</span></span>
<span id="cb10-3"><a href="empirical.html#cb10-3"></a><span class="co">#&gt; trt1 0.7792667 0.7248917 0.7036250 0.8050917</span></span>
<span id="cb10-4"><a href="empirical.html#cb10-4"></a><span class="co">#&gt; trt2 0.7870000 0.7269000 0.7226167 0.8037833</span></span>
<span id="cb10-5"><a href="empirical.html#cb10-5"></a><span class="co">#&gt; trt3 0.7296917 0.7157583 0.6723083 0.7726583</span></span>
<span id="cb10-6"><a href="empirical.html#cb10-6"></a><span class="co">#&gt; trt4 0.8101333 0.7431167 0.6943583 0.8294083</span></span>
<span id="cb10-7"><a href="empirical.html#cb10-7"></a><span class="co">#&gt; trt5 0.7488000 0.6822750 0.6551750 0.7712500</span></span></code></pre></div>
</div>
</div>
<div id="empirical-numerical-understanding" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.8</span> AFROC vs. wAFROC<a href="empirical.html#empirical-numerical-understanding" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The fact that the wAFROC gives equal importance to each diseased case while the AFROC gives more importance to diseased cases with more lesions can be illustrated with a fictitious small dataset consisting of <span class="math inline">\(K_1 = 4\)</span> non-diseased and <span class="math inline">\(K_2 = 5\)</span> diseased cases. The maximum number of NLs per case is two and the maximum number of lesions per case is three. The first two diseased cases have one lesion each, the third and fourth have two lesions each and the fifth has 3 lesions. Here is how we code the NL and LL z-samples (<code>t()</code> is the <code>R</code> transpose operator). The negative infinities represent unmarked locations. For example, the first non-diseased case has no NL marks, the second has one mark rated 0.5, etc., and the first diseased case has one NL mark rated 1.5, etc. The first lesion in the LL array was rated 0.9. the second was rated -0.2, …, and the 3 lesions in the fifth diseased case were rated 1, 2.5 and 1, respectively.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="empirical.html#cb11-1"></a>NL &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">array</span>(<span class="kw">c</span>(<span class="op">-</span><span class="ot">Inf</span>, <span class="op">-</span><span class="ot">Inf</span>,  </span>
<span id="cb11-2"><a href="empirical.html#cb11-2"></a>                 <span class="fl">0.5</span>, <span class="op">-</span><span class="ot">Inf</span>, </span>
<span id="cb11-3"><a href="empirical.html#cb11-3"></a>                 <span class="fl">0.7</span>, <span class="fl">0.6</span>, </span>
<span id="cb11-4"><a href="empirical.html#cb11-4"></a>                <span class="fl">-0.3</span>, <span class="op">-</span><span class="ot">Inf</span>, </span>
<span id="cb11-5"><a href="empirical.html#cb11-5"></a>                 <span class="fl">1.5</span>, <span class="op">-</span><span class="ot">Inf</span>, </span>
<span id="cb11-6"><a href="empirical.html#cb11-6"></a>                <span class="op">-</span><span class="ot">Inf</span>, <span class="op">-</span><span class="ot">Inf</span>, </span>
<span id="cb11-7"><a href="empirical.html#cb11-7"></a>                <span class="op">-</span><span class="ot">Inf</span>, <span class="op">-</span><span class="ot">Inf</span>, </span>
<span id="cb11-8"><a href="empirical.html#cb11-8"></a>                <span class="op">-</span><span class="ot">Inf</span>, <span class="op">-</span><span class="ot">Inf</span>,</span>
<span id="cb11-9"><a href="empirical.html#cb11-9"></a>              <span class="op">-</span><span class="st">  </span><span class="ot">Inf</span>, <span class="op">-</span><span class="ot">Inf</span>), <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">9</span>)))</span>
<span id="cb11-10"><a href="empirical.html#cb11-10"></a>LL &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">array</span>(<span class="kw">c</span>(<span class="fl">0.9</span>, <span class="op">-</span><span class="ot">Inf</span>, <span class="op">-</span><span class="ot">Inf</span>, </span>
<span id="cb11-11"><a href="empirical.html#cb11-11"></a>               <span class="fl">-0.2</span>, <span class="op">-</span><span class="ot">Inf</span>,<span class="op">-</span><span class="ot">Inf</span>, </span>
<span id="cb11-12"><a href="empirical.html#cb11-12"></a>                <span class="fl">1.6</span>, <span class="op">-</span><span class="ot">Inf</span>, <span class="op">-</span><span class="ot">Inf</span>, </span>
<span id="cb11-13"><a href="empirical.html#cb11-13"></a>                  <span class="dv">3</span>,    <span class="dv">2</span>, <span class="op">-</span><span class="ot">Inf</span>, </span>
<span id="cb11-14"><a href="empirical.html#cb11-14"></a>                  <span class="dv">1</span>,    <span class="fl">2.5</span>,  <span class="dv">1</span>), <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">5</span>)))</span></code></pre></div>
<p>The z-samples are converted to a dataset <code>frocData</code> as shown next:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="empirical.html#cb12-1"></a>frocData &lt;-<span class="st"> </span><span class="kw">Df2RJafrocDataset</span>(NL, LL, <span class="dt">perCase =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span></code></pre></div>
<p>In the above code <code>perCase = c(1,1,2,2,3)</code> specifies the number of lesions per case: 1 in the first diseased case, 1 in the second, 2 in the third, …, and 3 in the fifth. The function <code>Df2RJafrocDataset()</code> generates the dataset object.</p>
<p>The lesion weights are specified in the following lines.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="empirical.html#cb13-1"></a>frocData<span class="op">$</span>lesions<span class="op">$</span>weights[<span class="dv">3</span>,] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="op">-</span><span class="ot">Inf</span>)</span>
<span id="cb13-2"><a href="empirical.html#cb13-2"></a>frocData<span class="op">$</span>lesions<span class="op">$</span>weights[<span class="dv">4</span>,] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.9</span>, <span class="fl">0.1</span>, <span class="op">-</span><span class="ot">Inf</span>)</span>
<span id="cb13-3"><a href="empirical.html#cb13-3"></a>frocData<span class="op">$</span>lesions<span class="op">$</span>weights[<span class="dv">5</span>,] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>)</span></code></pre></div>
<p>The first and second diseased cases, which have only one lesion each, are assigned unit weights by default. The first lesion in the third diseased case has weight 0.1 and the second has weight 0.9 – notice that the weights sum to unity. The fourth diseased cases has the lesion weights reversed, 0.9 and 0.1. The three lesions in the fifth diseased case are assigned weights 0.3. 0.4 and 0.3.</p>
<div id="nl-and-ll-z-samples" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.8.1</span> NL and LL z-samples<a href="empirical.html#nl-and-ll-z-samples" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Shown next is the <code>NL</code> z-samples array; it has 9 rows, corresponding to the total number of cases (the first four correspond to non-diseased cases and the rest to diseased cases) and 2 columns, corresponding to the maximum number of NLs per case.</p>
<pre><code>#&gt; NL z-samples:
#&gt;       [,1] [,2]
#&gt;  [1,] -Inf -Inf
#&gt;  [2,]  0.5 -Inf
#&gt;  [3,]  0.7  0.6
#&gt;  [4,] -0.3 -Inf
#&gt;  [5,]  1.5 -Inf
#&gt;  [6,] -Inf -Inf
#&gt;  [7,] -Inf -Inf
#&gt;  [8,] -Inf -Inf
#&gt;  [9,] -Inf -Inf</code></pre>
<p>Shown next is the <code>LL</code> z-samples array; it has 5 rows, corresponding to the total number of diseased cases, and 3 columns, corresponding to the maximum number of LLs per case:</p>
<pre><code>#&gt; LL z-samples:
#&gt;      [,1] [,2] [,3]
#&gt; [1,]  0.9 -Inf -Inf
#&gt; [2,] -0.2 -Inf -Inf
#&gt; [3,]  1.6 -Inf -Inf
#&gt; [4,]  3.0  2.0 -Inf
#&gt; [5,]  1.0  2.5    1</code></pre>
</div>
<div id="lesion-weights" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.8.2</span> Lesion weights<a href="empirical.html#lesion-weights" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Show next is the lesion weights array:</p>
<pre><code>#&gt; lesion weights:
#&gt;      [,1] [,2] [,3]
#&gt; [1,]  1.0 -Inf -Inf
#&gt; [2,]  1.0 -Inf -Inf
#&gt; [3,]  0.1  0.9 -Inf
#&gt; [4,]  0.9  0.1 -Inf
#&gt; [5,]  0.3  0.4  0.3</code></pre>
<p>The negative infinities represent missing values.</p>
</div>
<div id="fpf" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.8.3</span> FPF<a href="empirical.html#fpf" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Shown next is the <code>FP</code> z-samples array. Since FPs are only possible on non-diseased cases, this is a length 4 row-vector. Each value is the maximum of the two <code>NL</code> z-samples for the corresponding non-diseased case. As an example, for case #3 the maximum of the two <code>NL</code> values is 0.7.</p>
<pre><code>#&gt; FP z-samples:
#&gt; [1] -Inf  0.5  0.7 -0.3</code></pre>
<p>Here are the sorted <code>FP</code> z-samples.</p>
<pre><code>#&gt; [1] -Inf -0.3  0.5  0.7</code></pre>
<p>The sorting makes it easy to construct the <code>FPF</code> values, shown next.</p>
<pre><code>#&gt; FPF values:
#&gt;  0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.250 0.500 0.500 0.750 1.000</code></pre>
<p>The first non-zero <code>FPF</code> value is <span class="math inline">\(0.25 = 1/4\)</span>, which occurs when a conceptual sliding threshold is lowered past the highest <code>FP</code> value, namely 0.7. (The 0.25 comes from 1 <code>FP</code> case divided by 4 non-diseased cases.) The next <code>FPF</code> value is <span class="math inline">\(0.5 = 2/4\)</span>, which occurs when the sliding threshold is lowered past the next-highest <code>FP</code> value, namely 0.5. The next <code>FPF</code> value is 0.75 and the last <code>FPF</code> value is unity.</p>
</div>
<div id="llf" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.8.4</span> LLF<a href="empirical.html#llf" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here are the sorted <code>LL</code> z-samples.</p>
<pre><code>#&gt;  [1] -Inf -Inf -Inf -Inf -Inf -Inf -Inf -0.2  0.9  1.0  1.0  1.6  2.0  2.5  3.0</code></pre>
<p>The <code>LLF</code> values are shown next.</p>
<pre><code>#&gt; LLF values:
#&gt;  0.000 0.111 0.222 0.333 0.444 0.667 0.778 0.778 0.778 0.889 0.889 1.000</code></pre>
<p>The first non-zero <code>LLF</code> value is 0.111, which occurs when the sliding threshold is lowered past the highest <code>LL</code> value, namely 3. The 0.111 comes from 1 LL divided by 9, the total number of lesions. The next <code>LLF</code> value is 0.222, which occurs when the sliding threshold is lowered past the next-highest <code>LL</code> value, namely 2.5 (2/9 = 0.222). The next <code>LLF</code> value is 0.333, which occurs when the sliding threshold is lowered past 2 (3/9 = 0.333), and so on.</p>
</div>
<div id="wllf" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.8.5</span> wLLF<a href="empirical.html#wllf" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The sorted <code>LL</code> z-samples array and the weights are used to construct the <code>wLLF</code> values shown next.</p>
<pre><code>#&gt; wLLF values:
#&gt;  0.000 0.180 0.260 0.280 0.300 0.420 0.620 0.620 0.620 0.820 0.820 1.000</code></pre>
<p>The first non-zero <code>wLLF</code> value is 0.18, which occurs when the sliding threshold is lowered past the highest <code>LL</code> value, namely 3. Since this comes from lesion #1 on diseased case #4, whose weight is 0.9, the corresponding incremental vertical jump is <span class="math inline">\(1/5*0.9 = 0.18\)</span>, which is also the net <code>wLLF</code> value corresponding to the most suspicious lesion crossing the cutoff. Notice that we are dividing by 5, the total number of diseased cases, not 9 as in the <code>LLF</code> example.</p>
<p>The next <code>wLLF</code> value is 0.26, which occurs when the sliding threshold is lowered past the next-highest <code>LL</code> value, namely 2.5, which comes from the 2nd lesion on the fifth diseased case with weight 0.4. The incremental jump in <code>wLLF</code> is <span class="math inline">\(1/5*0.4 = 0.08\)</span>. The net <code>wLLF</code> value corresponding to the two most suspicious lesions crossing the cutoff is <span class="math inline">\(1/5*0.9 + 1/5*0.4 = 0.26\)</span>.</p>
<p>The next <code>wLLF</code> value is 0.280, which occurs when the sliding threshold is lowered past 1.6, which comes from lesion #1 on diseased case #3, with weight 0.1, and the net <code>wLLF</code> value corresponding to the three most suspicious lesions crossing the cutoff is <span class="math inline">\(1/5*0.9 + 1/5*0.4 + 1/5*0.1 = 0.280\)</span>, and so on.</p>
<p>The reader should complete these hand-calculations to reproduce all of the <code>wLLF</code> values shown above. The values (FPF, LLF and wLLF) defining the AFROC and wAFROC are summarized here:</p>
<pre><code>#&gt;     FPF       LLF wLLF
#&gt; 1  0.00 0.0000000 0.00
#&gt; 2  0.00 0.1111111 0.18
#&gt; 3  0.00 0.2222222 0.26
#&gt; 4  0.00 0.3333333 0.28
#&gt; 5  0.00 0.4444444 0.30
#&gt; 6  0.00 0.6666667 0.42
#&gt; 7  0.00 0.7777778 0.62
#&gt; 8  0.25 0.7777778 0.62
#&gt; 9  0.50 0.7777778 0.62
#&gt; 10 0.50 0.8888889 0.82
#&gt; 11 0.75 0.8888889 0.82
#&gt; 12 1.00 1.0000000 1.00</code></pre>
<p>This shows that the empirical AFROC is defined by the following 6 operating points: (0,0), (0,0.7777778), (0.5,0.7777778), (0.5,0.8888889), (0.75, 0.8888889) and (1,1). Likewise, the empirical wAFROC is defined by the following 6 operating points: (0,0), (0,0.62), (0.5,62), (0.5,0.82), (0.75, 0.82) and (1,1). In each case one simply connects neighboring points with straight lines.</p>
<p>The hand-calculations also show why the AFROC gives more importance to diseased cases with more lesions while the wAFROC does not.</p>
<ul>
<li><p>Considering the AFROC, diseased case #5 with three lesions which contributes three vertical jumps to LLF totaling <span class="math inline">\(3/9 = 0.333333\)</span>.<a href="#fn20" class="footnote-ref" id="fnref20"><sup>20</sup></a> This is larger than the contribution to LLF of diseased case #1 with one lesion <span class="math inline">\(1/9 = 0.11111\)</span>.</p></li>
<li><p>Considering the wAFROC, the three lesions on diseased case #5 contribute <span class="math inline">\(1/5*0.3 + 1/5*0.4 + 1/5*0.3 = 0.2\)</span> to wLLF, the same as diseased case #1, <span class="math inline">\(1/5*1 = 0.2\)</span>.</p></li>
</ul>
<p>Shown in Fig. <a href="empirical.html#fig:plots-afrocPlot-wafrocPlot">3.1</a> are the empirical AFROC and wAFROC plots.</p>
<div class="figure"><span style="display:block;" id="fig:plots-afrocPlot-wafrocPlot"></span>
<img src="03-empirical_files/figure-html/plots-afrocPlot-wafrocPlot-1.png" alt="Left: AFROC plot; Right: corresponding wAFROC plot." width="672" />
<p class="caption">
FIGURE 3.1: Left: AFROC plot; Right: corresponding wAFROC plot.
</p>
</div>
<p>The operating points can be used to numerically calculate the AUCs under the empirical AFROC and wAFROC plots, as done in the following code:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="empirical.html#cb24-1"></a>afroc_auc &lt;-<span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span><span class="fl">0.7777778</span> <span class="op">+</span><span class="st"> </span></span>
<span id="cb24-2"><a href="empirical.html#cb24-2"></a><span class="st">  </span><span class="fl">0.25</span> <span class="op">*</span><span class="st"> </span><span class="fl">0.8888889</span> <span class="op">+</span><span class="st"> </span></span>
<span id="cb24-3"><a href="empirical.html#cb24-3"></a><span class="st">  </span><span class="fl">0.25</span> <span class="op">*</span><span class="st"> </span><span class="fl">0.8888889</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.8888889</span>) <span class="op">*</span><span class="st"> </span><span class="fl">0.25</span> <span class="op">/</span><span class="dv">2</span></span>
<span id="cb24-4"><a href="empirical.html#cb24-4"></a></span>
<span id="cb24-5"><a href="empirical.html#cb24-5"></a>wafroc_auc &lt;-<span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span><span class="fl">0.62</span> <span class="op">+</span><span class="st"> </span></span>
<span id="cb24-6"><a href="empirical.html#cb24-6"></a><span class="st">  </span><span class="fl">0.25</span> <span class="op">*</span><span class="st"> </span><span class="fl">0.82</span> <span class="op">+</span><span class="st"> </span></span>
<span id="cb24-7"><a href="empirical.html#cb24-7"></a><span class="st">  </span><span class="fl">0.25</span> <span class="op">*</span><span class="st"> </span><span class="fl">0.82</span> <span class="op">+</span><span class="st"> </span></span>
<span id="cb24-8"><a href="empirical.html#cb24-8"></a><span class="st">  </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.82</span>) <span class="op">*</span><span class="st"> </span><span class="fl">0.25</span> <span class="op">/</span><span class="dv">2</span></span>
<span id="cb24-9"><a href="empirical.html#cb24-9"></a></span>
<span id="cb24-10"><a href="empirical.html#cb24-10"></a><span class="kw">cat</span>(<span class="st">&quot;afroc_auc =&quot;</span>, afroc_auc,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb24-11"><a href="empirical.html#cb24-11"></a><span class="co">#&gt; afroc_auc = 0.8472222</span></span>
<span id="cb24-12"><a href="empirical.html#cb24-12"></a><span class="kw">cat</span>(<span class="st">&quot;wafroc_auc =&quot;</span>, wafroc_auc,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb24-13"><a href="empirical.html#cb24-13"></a><span class="co">#&gt; wafroc_auc = 0.7425</span></span></code></pre></div>
<p>The same AUC results are obtained using the function <code>UtilFigureOfMerit</code>:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="empirical.html#cb25-1"></a><span class="kw">cat</span>(<span class="st">&quot;AFROC AUC = &quot;</span>, </span>
<span id="cb25-2"><a href="empirical.html#cb25-2"></a>    <span class="kw">as.numeric</span>(<span class="kw">UtilFigureOfMerit</span>(frocData, <span class="dt">FOM =</span> <span class="st">&quot;AFROC&quot;</span>)),<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb25-3"><a href="empirical.html#cb25-3"></a><span class="co">#&gt; AFROC AUC =  0.8472222</span></span>
<span id="cb25-4"><a href="empirical.html#cb25-4"></a><span class="kw">cat</span>(<span class="st">&quot;wAFROC AUC = &quot;</span>, </span>
<span id="cb25-5"><a href="empirical.html#cb25-5"></a>    <span class="kw">as.numeric</span>(<span class="kw">UtilFigureOfMerit</span>(frocData, <span class="dt">FOM =</span> <span class="st">&quot;wAFROC&quot;</span>)),<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb25-6"><a href="empirical.html#cb25-6"></a><span class="co">#&gt; wAFROC AUC =  0.7425</span></span></code></pre></div>
<p>It is seen that the empirical plots consist of upward and rightward jumps starting from the origin (0,0) and ending at (1,1). Each upward jump is associated with a <code>LL</code> z-sample exceeding a virtual threshold. Each rightward jump is associated with a <code>FP</code> z-sample exceeding the threshold. Upward jumps tend to increase the area under the AFROC-based plots and rightward jumps tend to decrease it, i.e., correct decisions are rewarded and incorrect ones are penalized. If there are only upward jumps then the empirical plot rises from the origin to (0,1), where all lesions are correctly localized without any generating FPs and performance is perfect – the straight-line extension of the plot to (1,1) ensures that the net area is unity. If there are only horizontal jumps the operating point moves from the origin to (1,0), where none of the lesions are localized and every non-diseased case has at least one NL mark and despite the straight line extension to (1,1), the net area is zero. This represents worst possible performance.</p>
</div>
</div>
<div id="empirical-meanings" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.9</span> Interpretation of AUCs<a href="empirical.html#empirical-meanings" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<ul>
<li>The area under the AFROC is the probability that a lesion is rated higher than any mark on a non-diseased case.</li>
<li>The area under the weighted-AFROC is lesion-weight adjusted probability that a lesion is rated higher than any mark on a non-diseased case.</li>
</ul>
</blockquote>
</div>
<div id="empirical-instructive-cases" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.10</span> Instructive examples<a href="empirical.html#empirical-instructive-cases" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>I am including a few extreme cases that I have found to be instructive. These include chance level performance and observers who do not generate any marks.</p>
<div id="empirical-instructive-cases-FROC" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.10.1</span> The FROC<a href="empirical.html#empirical-instructive-cases-FROC" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The chance level FROC is a “flat-liner” hugging the x-axis except for a possible upturn at large NLF. For an observer who does not generate any marks the FROC plot contains but one point, the origin, and <span class="math inline">\(A_{\text{FROC}}=0\)</span>.</p>
</div>
<div id="empirical-instructive-cases-ROC" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.10.2</span> The ROC<a href="empirical.html#empirical-instructive-cases-ROC" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The chance level ROC is the positive diagonal connecting (0,0) to (1,1). There could be several operating points on this diagonal (apart from sampling effects) but <span class="math inline">\(A_{\text{ROC}}=0.5\)</span>.</p>
<p>An observer who does not generate any marks the ROC plot consists of two points, the origin and (1,1) and <span class="math inline">\(A_{\text{ROC}}=0.5\)</span>.</p>
</div>
<div id="empirical-instructive-cases-AFROC" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.10.3</span> The AFROC<a href="empirical.html#empirical-instructive-cases-AFROC" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="empirical-instructive-cases-AFROC-chance-level" class="section level4 hasAnchor">
<h4><span class="header-section-number">3.10.3.1</span> Chance level performance<a href="empirical.html#empirical-instructive-cases-AFROC-chance-level" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The chance level AFROC is not the line connecting (0,0) to (1,1). This is a serious misconception that I have encountered. A chance level observer will generate a “flat-liner” but this time the plot ends at (1,0) and the straight line extension will be a vertical line connecting (1,0) to (1,1) and <span class="math inline">\(A_{\text{AFROC}}=0\)</span>.</p>
</div>
<div id="empirical-empirical-instructive-cases-AFROC-no-marks" class="section level4 hasAnchor">
<h4><span class="header-section-number">3.10.3.2</span> Case of no marks<a href="empirical.html#empirical-empirical-instructive-cases-AFROC-no-marks" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This is a highly interesting and instructive example. The AFROC plot is a straight line connecting (0,0) and (1,1) which could be mistakenly termed as representing chance level performance. This is far from the truth.</p>
<blockquote>
<p>An expert radiologist successfully screens out non-diseased cases and sees nothing suspicious in any of them – not mistaking variants of normal anatomy for false lesions on non-diseased cases is a sign of expertise. Suppose the lesions on diseased cases are very difficult to see, even for the expert, so the radiologist does not mark any of them in addition to not marking any NLs on diseased cases. <strong>The expert radiologist therefore does not report anything, i.e., generates no marks, and the operating point is “stuck” at the origin (0,0).</strong> Even in this unusual situation, one would be justified in connecting the origin to (1,1) and claiming area under AFROC is 0.5. The extension gives the radiologist credit for not marking any non-diseased case; of course, the radiologist does not get any credit for marking any of the lesions. An even better radiologist, who finds and marks some of the lesions, will score higher, and AFROC-AUC will exceed 0.5.</p>
</blockquote>
</div>
</div>
<div id="empirical-instructive-cases-wAFROC" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.10.4</span> The wAFROC<a href="empirical.html#empirical-instructive-cases-wAFROC" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Similar comments apply to the wAFROC as already described above for AFROC.</p>
</div>
</div>
<div id="empirical-froc-auc-poor" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.11</span> FROC-AUC is a poor measure<a href="empirical.html#empirical-froc-auc-poor" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Regarding the ROC-AUC, i.e., <span class="math inline">\(A_{\text{ROC}}\)</span>, as the gold standard against which all other figures of merit should be compared for consistency in orderings, shown next are plots of <span class="math inline">\(A_{\text{FROC}}\)</span>, <span class="math inline">\(A_{\text{AFROC}}\)</span> and <span class="math inline">\(A_{\text{wAFROC}}\)</span> vs. <span class="math inline">\(A_{\text{ROC}}\)</span> for the dataset used in the previous illustrations.</p>
<div id="plot-of-froc-auc-vs.-roc-auc" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.11.1</span> Plot of FROC AUC vs. ROC AUC<a href="empirical.html#plot-of-froc-auc-vs.-roc-auc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following is the plot of <span class="math inline">\(A_{\text{FROC}}\)</span> vs. <span class="math inline">\(A_{\text{ROC}}\)</span>. There are 20 points on the plot corresponding to 5 treatments and 4 readers. The straight line is a least squares fit. Note the poor correlation and negative slope between <span class="math inline">\(A_{\text{FROC}}\)</span> and <span class="math inline">\(A_{\text{ROC}}\)</span>, <span class="math inline">\(R^2\)</span> = 0.0347791, slope = -0.3978636.</p>
<p><img src="03-empirical_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>The reason should be fairly obvious. The FROC is unconstrained in the NLF direction and the area under the plot <em>rewards</em> an observer who generates more NLs, i.e., as the operating point moves further to the right. (The perfect observer whose FROC plot is the vertical line connecting (0,0) and (0,1) is heavily penalized since <span class="math inline">\(A_{\text{FROC}} = 0\)</span> for this observer.) One can try to try to avoid this problem by limiting the area under the FROC to that between <span class="math inline">\(\text{NLF} = 0\)</span> and <span class="math inline">\(\text{NLF} = x\)</span> where <span class="math inline">\(x\)</span> is an arbitrarily chosen fixed value – indeed the partial area procedure has been used by CAD algorithm designers. Since the choice of <span class="math inline">\(x\)</span> is arbitrary the procedure is subjective. The method would fail for any observer with <span class="math inline">\(\text{NLF}_{max} &lt; x\)</span> as then the partial area is undefined. This forces the algorithm designer to chose <span class="math inline">\(x\)</span> as the minimum of all <span class="math inline">\(\text{NLF}_{max}\)</span> values over all observers and treatments, which would exclude a lot of data and lead to a statistical power penalty.</p>
</div>
<div id="plot-of-afroc-auc-vs.-roc-auc" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.11.2</span> Plot of AFROC AUC vs. ROC AUC<a href="empirical.html#plot-of-afroc-auc-vs.-roc-auc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following is the plot of <span class="math inline">\(A_{\text{AFROC}}\)</span> vs. <span class="math inline">\(A_{\text{ROC}}\)</span>. This time there is a strong positive correlation between the two, <span class="math inline">\(R^2\)</span> = 0.7258723, slope = 0.8649687. The reason is that the AFROC is fully contained in the unit square. An observer who generates more NL marks will yield smaller <span class="math inline">\(A_{\text{AFROC}}\)</span> – as the abscissa of the AFROC approaches unity the restriction to the unit square ensures that AUC will decrease.</p>
<p><img src="03-empirical_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
</div>
<div id="plot-of-wafroc-auc-vs.-roc-auc" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.11.3</span> Plot of wAFROC AUC vs. ROC AUC<a href="empirical.html#plot-of-wafroc-auc-vs.-roc-auc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following is the plot of <span class="math inline">\(A_{\text{wAFROC}}\)</span> vs. <span class="math inline">\(A_{\text{ROC}}\)</span>. Again, there is a strong positive correlation between the two, <span class="math inline">\(R^2\)</span> = 0.8569511, slope = 1.0691159. The reason is that the wAFROC is also fully contained in the unit square.</p>
<p><img src="03-empirical_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
</div>
</div>
<div id="empirical-AFROC1" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.12</span> The AFROC1 plot<a href="empirical.html#empirical-AFROC1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Historically the AFROC originally used a different definition of FPF, resulting in what is retrospectively termed the AFROC1 plot. Since NLs can occur on diseased cases, it is possible to define an inferred-“FP” z-sample on a <em>diseased case</em> as the maximum of all NL z-samples on the case, or <span class="math inline">\(-\infty\)</span> if the case has no NLs. The quotes emphasize that this is non-standard usage of ROC terminology: in an ROC study, a FP can only occur on a <em>non-diseased case</em>. Since both case-level truth states are allowed, the highest false positive (FP) z-sample for case <span class="math inline">\(k_t t\)</span> is [the “1” superscript below is necessary to distinguish it from Eqn. <a href="empirical.html#eq:empirical-FP">(3.13)</a>]:</p>
<p><span class="math display" id="eq:empirical-FP1">\[\begin{equation}
\left.
\begin{aligned}
\begin{matrix}
FP_{k_1 t}^1=&amp;\max_{l_1} \left ( z_{k_t t l_1 1 } \right ) &amp; \text{if} &amp; l_1 \neq \varnothing\\
FP_{k_t t}^1=&amp;-\infty &amp; \text{if} &amp; l_1 = \varnothing
\end{matrix}
\end{aligned}
\right \}
\tag{3.23}
\end{equation}\]</span></p>
<p><span class="math inline">\(FP_{k_t t}^1\)</span> is the maximum over all latent NL marks, labeled by the location index <span class="math inline">\(l_1\)</span>, occurring in case <span class="math inline">\(k_t t\)</span>, or <span class="math inline">\(-\infty\)</span> if <span class="math inline">\(l_1 = \varnothing\)</span>. The corresponding false positive fraction <span class="math inline">\(FPF_r^1\)</span> is defined by:</p>
<p><span class="math display" id="eq:empirical-fpf1">\[\begin{equation}
\left.
\begin{aligned}
FPF_r^1 
&amp;\equiv FPF_r^1\left ( \zeta_r \right ) \\
&amp;= \frac{1}{K_1+K_2}\sum_{t=1}^{2}\sum_{k_t=1}^{K_t} \mathbb{I}\left ( FP_{k_t t}^1 \geq \zeta_r \right )
\end{aligned}
\right \}
\tag{3.24}
\end{equation}\]</span></p>
<p>Note the subtle differences between Eqn. <a href="empirical.html#eq:empirical-fpf">(3.14)</a> and Eqn. <a href="empirical.html#eq:empirical-fpf1">(3.24)</a>. The latter counts “FPs” on non-diseased and diseased cases while Eqn. <a href="empirical.html#eq:empirical-fpf">(3.14)</a> counts FPs on non-diseased cases only, and for that reason the denominators in the two equations are different. The advisability of allowing a diseased case to generate both a TP and a FP may be questionable, however, this plot is useful in applications where all or almost all cases are diseased.</p>
<div id="empirical-definition-empirical-auc-afroc1" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.12.1</span> Empirical AFROC1 plot and AUC<a href="empirical.html#empirical-definition-empirical-auc-afroc1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>The empirical AFROC1 plot connects adjacent operating points <span class="math inline">\(\left ( FPF_r^1, \text{LLF}_r \right )\)</span>, including the origin (0,0) and (1,1), with straight lines. The only difference between AFROC1 plot and the AFROC plot is the x-axis. The area under this plot is the empirical AFROC1 AUC, denoted <span class="math inline">\(A_{\text{AFROC1}}\)</span>.</p>
</blockquote>
</div>
<div id="empirical-afroc1-plot-illustration" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.12.2</span> Illustration with a dataset<a href="empirical.html#empirical-afroc1-plot-illustration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following code uses <code>dataset04</code> to illustrate an empirical ROC plot for treatment 1 and reader 1.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="empirical.html#cb26-1"></a>ret &lt;-<span class="st"> </span><span class="kw">PlotEmpiricalOperatingCharacteristics</span>(</span>
<span id="cb26-2"><a href="empirical.html#cb26-2"></a>  dataset04, </span>
<span id="cb26-3"><a href="empirical.html#cb26-3"></a>  <span class="dt">trts =</span> <span class="dv">1</span>, <span class="dt">rdrs =</span> <span class="dv">1</span>, <span class="dt">opChType =</span> <span class="st">&quot;AFROC1&quot;</span>)</span>
<span id="cb26-4"><a href="empirical.html#cb26-4"></a><span class="kw">print</span>(ret<span class="op">$</span>Plot)</span></code></pre></div>
<p><img src="03-empirical_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<p>Shown next is calculation of the figure of merit for this dataset.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="empirical.html#cb27-1"></a><span class="kw">UtilFigureOfMerit</span>(dataset04, <span class="dt">FOM =</span> <span class="st">&quot;AFROC1&quot;</span>)</span>
<span id="cb27-2"><a href="empirical.html#cb27-2"></a><span class="co">#&gt;           rdr1      rdr3      rdr4      rdr5</span></span>
<span id="cb27-3"><a href="empirical.html#cb27-3"></a><span class="co">#&gt; trt1 0.7744718 0.7157218 0.7229225 0.7913908</span></span>
<span id="cb27-4"><a href="empirical.html#cb27-4"></a><span class="co">#&gt; trt2 0.7826585 0.7278169 0.7364437 0.7897887</span></span>
<span id="cb27-5"><a href="empirical.html#cb27-5"></a><span class="co">#&gt; trt3 0.7412852 0.6868310 0.6946303 0.7573415</span></span>
<span id="cb27-6"><a href="empirical.html#cb27-6"></a><span class="co">#&gt; trt4 0.8087852 0.7346831 0.7343486 0.8155634</span></span>
<span id="cb27-7"><a href="empirical.html#cb27-7"></a><span class="co">#&gt; trt5 0.7580810 0.6825704 0.6643662 0.7742782</span></span></code></pre></div>
</div>
</div>
<div id="empirical-wAFROC1" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.13</span> The weighted-AFROC1 (wAFROC1) plot<a href="empirical.html#empirical-wAFROC1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Similar to the logic for introducing the wAFROC plot as a way of giving equal importance to all diseased cases and allowing the clinical importance of lesions to be modeled by appropriate weights, we introduce a weighted version of the AFROC1, termed the wAFROC1. The ordinate of this plot is the weighted lesion localization fraction <span class="math inline">\(\text{wLLF}_r\)</span> defined in Eqn. <a href="empirical.html#eq:empirical-wLLFr">(3.22)</a>. The abscissa is FPF1, defined in Eqn. <a href="empirical.html#eq:empirical-fpf1">(3.24)</a>.</p>
<div id="empirical-definition-empirical-auc-wafroc1" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.13.1</span> Empirical wAFROC1 plot and AUC<a href="empirical.html#empirical-definition-empirical-auc-wafroc1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>The empirical weighted-AFROC1 (wAFROC1) plot connects adjacent operating points <span class="math inline">\(\left ( FPF_r^1, \text{wLLF}_r \right )\)</span>, including the origin (0,0) and (1,1), with straight lines. The only difference between it and the wAFROC plot is in the x-axis. The area under this plot is the empirical weighted-AFROC AUC, denoted <span class="math inline">\(A_{\text{wAFROC1}}\)</span>.</p>
</blockquote>
</div>
<div id="empirical-wafroc1-plot-illustration" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.13.2</span> Illustration with a dataset<a href="empirical.html#empirical-wafroc1-plot-illustration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following code uses <code>dataset04</code> to illustrate an empirical wAFROC1 plot for treatment 1 and reader 1.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="empirical.html#cb28-1"></a>ret &lt;-<span class="st"> </span><span class="kw">PlotEmpiricalOperatingCharacteristics</span>(</span>
<span id="cb28-2"><a href="empirical.html#cb28-2"></a>  dataset04, </span>
<span id="cb28-3"><a href="empirical.html#cb28-3"></a>  <span class="dt">trts =</span> <span class="dv">1</span>, <span class="dt">rdrs =</span> <span class="dv">1</span>, <span class="dt">opChType =</span> <span class="st">&quot;wAFROC1&quot;</span>)</span>
<span id="cb28-4"><a href="empirical.html#cb28-4"></a><span class="kw">print</span>(ret<span class="op">$</span>Plot)</span></code></pre></div>
<p><img src="03-empirical_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<p>Shown next is calculation of the figure of merit for this dataset.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="empirical.html#cb29-1"></a><span class="kw">UtilFigureOfMerit</span>(dataset04, <span class="dt">FOM =</span> <span class="st">&quot;wAFROC1&quot;</span>)</span>
<span id="cb29-2"><a href="empirical.html#cb29-2"></a><span class="co">#&gt;           rdr1      rdr3      rdr4      rdr5</span></span>
<span id="cb29-3"><a href="empirical.html#cb29-3"></a><span class="co">#&gt; trt1 0.8068333 0.7298917 0.7262042 0.8058542</span></span>
<span id="cb29-4"><a href="empirical.html#cb29-4"></a><span class="co">#&gt; trt2 0.8084625 0.7379917 0.7363083 0.8010167</span></span>
<span id="cb29-5"><a href="empirical.html#cb29-5"></a><span class="co">#&gt; trt3 0.7680875 0.7075583 0.6890208 0.7743875</span></span>
<span id="cb29-6"><a href="empirical.html#cb29-6"></a><span class="co">#&gt; trt4 0.8348750 0.7533917 0.7160250 0.8308333</span></span>
<span id="cb29-7"><a href="empirical.html#cb29-7"></a><span class="co">#&gt; trt5 0.7857708 0.6953292 0.6605167 0.7774000</span></span></code></pre></div>
</div>
</div>
<div id="empirical-summary" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.14</span> Summary<a href="empirical.html#empirical-summary" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here is a summary of the plots defined from FROC data along with my recommendations:</p>
<table>
<caption>
<span id="tab:empirical-summary">TABLE 3.2: </span>Summary of plots from FROC data. All empirical plots except FROC include a straight line extension from the uppermost observed point to (1,1).
</caption>
<thead>
<tr>
<th style="text-align:left;">
OC
</th>
<th style="text-align:left;">
Abscissa
</th>
<th style="text-align:left;">
Ordinate
</th>
<th style="text-align:left;">
Comments
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
FROC
</td>
<td style="text-align:left;">
NLF
</td>
<td style="text-align:left;">
LLF
</td>
<td style="text-align:left;">
Not recommended
</td>
</tr>
<tr>
<td style="text-align:left;">
ROC
</td>
<td style="text-align:left;">
FPF
</td>
<td style="text-align:left;">
TPF
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
AFROC
</td>
<td style="text-align:left;">
FPF
</td>
<td style="text-align:left;">
LLF
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
wAFROC
</td>
<td style="text-align:left;">
FPF
</td>
<td style="text-align:left;">
wLLF
</td>
<td style="text-align:left;">
Recommended when <span class="math inline">\(K_1 \approx K_2\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
AFROC1
</td>
<td style="text-align:left;">
FPF1
</td>
<td style="text-align:left;">
LLF
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
wAFROC1
</td>
<td style="text-align:left;">
FPF1
</td>
<td style="text-align:left;">
wLLF
</td>
<td style="text-align:left;">
Recommended when <span class="math inline">\(K_1 \ll K_2\)</span>
</td>
</tr>
</tbody>
</table>
</div>
<div id="empirical-theorem-1" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.15</span> Appendix 1: Proof of formula for wAFROC-AUC<a href="empirical.html#empirical-theorem-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The area <span class="math inline">\(\text{A}_{wAFROC}\)</span> under the empirical wAFROC plot is obtained by summing the areas of individual trapezoids defined by dropping vertical lines from each pair of adjacent operating points to the x-axis. A sample plot is shown Fig. <a href="empirical.html#fig:empirical-theorems">3.2</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:empirical-theorems"></span>
<img src="images/03-empiricalPlots/proofFigure.png" alt="An example wAFROC plot; from left to right, the two shaded areas correspond to $A_i$ and  $A_0$, respectively, defined below." width="300pt" />
<p class="caption">
FIGURE 3.2: An example wAFROC plot; from left to right, the two shaded areas correspond to <span class="math inline">\(A_i\)</span> and <span class="math inline">\(A_0\)</span>, respectively, defined below.
</p>
</div>
<!-- Following code commented out as it might break ggplot2 -->
<!-- Replaced with above code importing the png file -->
<!-- ```{r, echo=FALSE, cache=TRUE} -->
<!-- ratings <- c(2.012014287,  2.303861492,    -2.67621502,    -0.731465008,    -->
<!--              2.012014287,  2.923751322, 0.778163587, -1.080014238, -2.67621502) -->
<!-- truth <- c(rep(0, 4), rep(1, 5)) -->
<!-- weight <- c(rep(5, 4), 3, 5, 2, 2, 3) / 5 -->
<!-- pos <- rep(0, 9) -->
<!-- pos[5] <- 0.1 -->
<!-- ret <- data.frame(ratings = ratings, truth = truth, weight = weight, pos = pos) -->
<!-- fpScores <- sort(unique(ratings[truth == 0]), decreasing = TRUE) -->
<!-- llScores <- sort(unique(ratings[truth == 1]), decreasing = TRUE) -->
<!-- scores <- sort(unique(ratings), decreasing = TRUE) -->
<!-- fpf <- cumsum(as.vector(table(ratings[truth == 0])))/sum(truth == 0) -->
<!-- wllf <- rep(NA, length(llScores)) -->
<!-- for (z in 1:length(llScores)){ -->
<!--   wllf[z] <- sum(weight[(ratings == llScores[z]) & (truth == 1)]) -->
<!-- } -->
<!-- wllf <- cumsum(wllf)/sum(weight[5:9]) -->
<!-- FPF <- 0:length(scores) -->
<!-- wLLF <- FPF -->
<!-- numFP <- 1 -->
<!-- numLL <- 1 -->
<!-- for (k in 1:length(scores)) { -->
<!--   if (!is.na(fpScores[numFP]) && fpScores[numFP] >= scores[k]) { -->
<!--     FPF[k + 1] <- fpf[numFP] -->
<!--     numFP <- numFP + 1 -->
<!--   } else { -->
<!--     FPF[k + 1] <- FPF[k] -->
<!--   } -->
<!--   if (!is.na(llScores[numLL]) && llScores[numLL] >= scores[k]) { -->
<!--     wLLF[k + 1] <- wllf[numLL] -->
<!--     numLL <- numLL + 1 -->
<!--   } else { -->
<!--     wLLF[k + 1] <- wLLF[k] -->
<!--   } -->
<!-- } -->
<!-- FPF[k + 1] <- 1 -->
<!-- wLLF[k + 1] <- 1 -->
<!-- wAFROC_Points <- data.frame(FPF = FPF, wLLF = wLLF) -->
<!-- zetaZero_x <- wAFROC_Points$FPF[length(wAFROC_Points$FPF)] -->
<!-- zetaZero_y <- wAFROC_Points$wLLF[length(wAFROC_Points$wLLF)] -->
<!-- Zero <- data.frame(x = zetaZero_x, y = zetaZero_y, label = "0") -->
<!-- zetaOne_x <- wAFROC_Points$FPF[length(wAFROC_Points$FPF) - 1] -->
<!-- zetaOne_y <- wAFROC_Points$wLLF[length(wAFROC_Points$wLLF) - 1] -->
<!-- One <- data.frame(x = zetaOne_x, y = zetaOne_y, label = "1") -->
<!-- zeta1_x <- wAFROC_Points$FPF[3] -->
<!-- zeta1_y <- wAFROC_Points$wLLF[3] -->
<!-- zeta1 <- data.frame(x = c(zeta1_x, zeta1_x), y = c(0, zeta1_y)) -->
<!-- i1 <- data.frame(x = zeta1_x, y = zeta1_y, label = "i + 1") -->
<!-- zeta2_x <- wAFROC_Points$FPF[4] -->
<!-- zeta2_y <- wAFROC_Points$wLLF[4] -->
<!-- zeta2 <- data.frame(x = c(zeta2_x, zeta2_x), y = c(0, zeta2_y)) -->
<!-- i2 <- data.frame(x = zeta2_x, y = zeta2_y, label = "i") -->
<!-- shade1 <- data.frame(FPF = c(zeta2_x, zeta1_x, zeta1_x, zeta2_x), wLLF = c(zeta2_y, zeta1_y, 0, 0)) -->
<!-- shade2 <- data.frame(FPF = c(1, 1, 0.75, 0.75), wLLF = c(1, 0, 0, 0.8)) -->
<!-- p <- ggplot(wAFROC_Points, aes(x = FPF, y = wLLF) ) + geom_polygon(data = shade1, fill = 'grey') + geom_polygon(data = shade2, fill = 'grey') +  -->
<!--   geom_line(linewidth = 1) + geom_point(size = 4) +  -->
<!--   geom_line(data = zeta1, aes(x = x, y = y), linetype = 2) + geom_line(data = zeta2, aes(x = x, y = y), linetype = 2) + -->
<!--   geom_segment(aes(x = 0.75, y = 0, xend = 0.75, yend = 0.8), linetype = 2) +   -->
<!--   geom_segment(aes(x = 1, y = 0.8, xend = 0.75, yend = 0.8), linetype = 2) +   -->
<!--   geom_text(data = Zero, aes(x = x, y = y, label = label), vjust = 2, hjust = 1.1, size = 9) +  -->
<!--   geom_text(data = One, aes(x = x, y = y, label = label), vjust = 0.5, hjust = 1.2, size = 10) +  -->
<!--   geom_text(data = i1, aes(x = x, y = y, label = label), vjust = -0.5, hjust = 1, size = 10) +  -->
<!--   geom_text(data = i2, aes(x = x, y = y, label = label), vjust = -1.9, hjust = 3, size = 10) +  -->
<!--   annotation_custom(grob = textGrob(bquote(italic(wLLF["1"])), -->
<!--                                     gp = gpar(fontsize = 8)),  -->
<!--                     xmin = 0.87, xmax = 0.87,  -->
<!--                     ymin = 0.47, ymax = 0.47) + -->
<!--   geom_segment(aes(x = 0.85, y = 0.5, xend = 0.75, yend = 0.6), arrow = arrow(angle = 20, length = unit(0.5, "cm"))) +  -->
<!--   annotation_custom(grob = textGrob(bquote(italic(wLLF[i + "1"])), -->
<!--                                     gp = gpar(fontsize = 8)),  -->
<!--                     xmin = zeta1_x - 0.15, xmax = zeta1_x - 0.05,  -->
<!--                     ymin = 0.25, ymax = 0.25) + -->
<!--   geom_segment(aes(x = zeta1_x - 0.1, y = 0.22, xend = zeta1_x, yend = 0.15), arrow = arrow(angle = 20, length = unit(0.5, "cm"))) +  -->
<!--   annotation_custom(grob = grobTree(textGrob(bquote(italic(wLLF[i])), -->
<!--                                              gp = gpar(fontsize = 8))),  -->
<!--                     xmin = zeta2_x + 0.05, xmax = zeta2_x + 0.15,  -->
<!--                     ymin = 0.35, ymax = 0.35) + -->
<!--   geom_segment(aes(x = zeta2_x + 0.1, y = 0.32, xend = zeta2_x, yend = 0.25), arrow = arrow(angle = 20, length = unit(0.5, "cm"))) +  -->
<!--   annotation_custom(grob = textGrob(bquote(italic(FPF[i]-FPF[i + "1"])), -->
<!--                                     gp = gpar(fontsize = 8)),  -->
<!--                     xmin = 0.375, xmax = 0.375,  -->
<!--                     ymin = 0.1, ymax = 0.1) + -->
<!--   geom_segment(aes(x = 0.375, y = 0.09, xend = 0.3, yend = 0), arrow = arrow(angle = 20, length = unit(0.5, "cm"))) +  -->
<!--   annotation_custom(grob = textGrob(bquote(italic(1-FPF["1"])), -->
<!--                                     gp = gpar(fontsize = 8)),  -->
<!--                     xmin = 0.875, xmax = 0.875,  -->
<!--                     ymin = 0.7, ymax = 0.7) + -->
<!--   geom_segment(aes(x = 0.875, y = 0.72, xend = 0.9, yend = 0.8), arrow = arrow(angle = 20, length = unit(0.5, "cm"))) +  -->
<!--   theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),  -->
<!--                      axis.text = element_text(size = 8), axis.title = element_text(size = 8)) + -->
<!--   scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) + -->
<!--   coord_cartesian(ylim = c(0,1), x = c(0,1)) -->
<!-- ``` -->
<!-- ```{r empirical-theorems, fig.cap="An example wAFROC plot; from left to right, the two shaded areas correspond to $A_i$ and  $A_0$, respectively, defined below.", fig.show='hold', echo=FALSE} -->
<!-- print(p) -->
<!-- ``` -->
<p>The operating point labeled <span class="math inline">\(i\)</span> has coordinates <span class="math inline">\(\left ( \text{FPF}_i, \text{wLLF}_i \right )\)</span> given by Eqn. <a href="empirical.html#eq:empirical-fpf">(3.14)</a> and Eqn. <a href="empirical.html#eq:empirical-wLLFr">(3.22)</a>.</p>
<p>The area <span class="math inline">\(A_i\)</span> of the leftmost shaded trapezoid in Fig. <a href="empirical.html#fig:empirical-theorems">3.2</a> is:</p>
<p><span class="math display" id="eq:empirical-auc-1">\[\begin{equation}
A_i = \frac{\left (\text{FPF}_i - \text{FPF}_{i+1}\right )\left (\text{wLLF}_i + \text{wLLF}_{i+1}\right )}{2}
\tag{3.25}
\end{equation}\]</span></p>
<p>The weighted lesion localization fraction <span class="math inline">\(\text{wLLF}_r\)</span> corresponding to threshold <span class="math inline">\(\zeta_r\)</span> is defined by Eqn. <a href="empirical.html#eq:empirical-wLLFr">(3.22)</a>. It follows that:</p>
<p><span class="math display" id="eq:empirical-theorem2">\[\begin{equation}
\left. 
\begin{aligned}
A_i =&amp;  \frac{\left (\text{FPF}_i - \text{FPF}_{i+1}\right )}{2} \times \\ 
&amp; \frac{1}{K_2}\left[ \sum_{k_2=1}^{K_2}\sum_{l_2=1}^{L_{k_2 2}}W_{k_2 l_2} \mathbb{I}\left ( z_{k_2 2 l_2 2} \geq \zeta_i \right ) \right. \\
&amp;+ \left. \sum_{k_2=1}^{K_2}\sum_{l_2=1}^{L_{k_2 2}}W_{k_2 l_2} \mathbb{I}\left ( z_{k_2 2 l_2 2} \geq \zeta_{i+1} \right ) \right]  
\end{aligned}
\right \} 
\tag{3.26}
\end{equation}\]</span></p>
<p>Using the probabilistic relation:</p>
<p><span class="math display" id="eq:empirical-appendix-1">\[\begin{equation}
\mathbb{I}\left ( z_{k_2 2 l_2 2} \geq \zeta_i \right ) = \mathbb{I}\left ( \zeta_{i} \leq z_{k_2 2 l_2 2} &lt; \zeta_{i+1} \right ) + \mathbb{I}\left ( z_{k_2 2 l_2 2} \geq \zeta_{i+1} \right )
\tag{3.27}
\end{equation}\]</span></p>
<p>we can expand the first term inside the square bracket:</p>
<p><span class="math display">\[\begin{equation}
\left. 
\begin{aligned}
A_i =&amp;  \frac{\left (\text{FPF}_i - \text{FPF}_{i+1}\right )}{2K_2} \times \\ 
&amp; \left[ \sum_{k_2=1}^{K_2}\sum_{l_2=1}^{L_{k_2 2}}W_{k_2 l_2} \mathbb{I}\left ( \zeta_{i} \leq z_{k_2 2 l_2 2} &lt; \zeta_{i+1} \right ) \right. \\
&amp;+ \sum_{k_2=1}^{K_2}\sum_{l_2=1}^{L_{k_2 2}}W_{k_2 l_2} \mathbb{I}\left ( z_{k_2 2 l_2 2} \geq \zeta_{i+1} \right ) \\ 
&amp;+ \left. \sum_{k_2=1}^{K_2}\sum_{l_2=1}^{L_{k_2 2}}W_{k_2 l_2} \mathbb{I}\left ( z_{k_2 2 l_2 2} \geq \zeta_{i+1} \right ) \right]  
\end{aligned}
\right \} 
\end{equation}\]</span></p>
<p>The last two terms are equal, therefore:</p>
<p><span class="math display" id="eq:empirical-theorem3">\[\begin{equation}
\left. 
\begin{aligned}
A_i =&amp; \frac{\left (\text{FPF}_i - \text{FPF}_{i+1}\right )}{K_2} \times \\ 
&amp; \left[ \frac{1}{2} \sum_{k_2=1}^{K_2}\sum_{l_2=1}^{L_{k_2 2}}W_{k_2 l_2} \mathbb{I}\left ( \zeta_{i} \leq z_{k_2 2 l_2 2} &lt; \zeta_{i+1} \right ) \right. \\
&amp; +\left. \sum_{k_2=1}^{K_2}\sum_{l_2=1}^{L_{k_2 2}}W_{k_2 l_2} \mathbb{I}\left ( z_{k_2 2 l_2 2} \geq \zeta_{i+1} \right ) \right]  
\end{aligned}
\right \} 
\tag{3.28}
\end{equation}\]</span></p>
<p>The final steps of the proof require that the z-samples be converted to integer ratings, which can be done without loss of ordering information if the number of bins is sufficiently large. Let <span class="math inline">\(r_{k_t t l_s s}\)</span> denote the integer rating of mark <span class="math inline">\(k_t tl_s s\)</span>, which implies that marks with z-samples satisfying <span class="math inline">\(\zeta_i \leq z_{k_t tl_s s} &lt; \zeta_{i+1}\)</span>, where <span class="math inline">\(i=0,1,...R\)</span>, are rated <span class="math inline">\(i\)</span> (dummy thresholds <span class="math inline">\(\zeta_0\)</span> and <span class="math inline">\(\zeta_{R+1}\)</span> are defined as <span class="math inline">\(-\infty\)</span> and <span class="math inline">\(+\infty\)</span>, respectively).</p>
<p>From Eqn. <a href="empirical.html#eq:empirical-fpf">(3.14)</a> it follows that:</p>
<p><span class="math display" id="eq:empirical-theorem4">\[\begin{equation}
\left. 
\begin{aligned}
\text{FPF}_i - \text{FPF}_{i+1}=&amp; \frac{1}{K_1} \left[ \sum_{k_1=1}^{K_1} \mathbb{I}\left ( \max_{l_1} \left (z_{k_1 1 l_1 1}  \right ) \geq \zeta_i \right ) - \sum_{k_1=1}^{K_1} \mathbb{I}\left ( z_{k_1 1 l_1 1} \geq \zeta_{i+1} \right ) \right] \\
=&amp; \frac{1}{K_1} \sum_{k_1=1}^{K_1} \mathbb{I}\left ( \zeta_i \leq \max_{l_1} \left (z_{k_1 1 l_1 1}  \right ) &lt; \zeta_{i+1} \right ) 
\end{aligned}
\right \} 
\tag{3.29}
\end{equation}\]</span></p>
<p>Because of the binning rule, <span class="math inline">\(\mathbb{I}\left ( \zeta_i \leq \max_{l_1} \left (z_{k_1 1 l_1 1} \right ) &lt; \zeta_{i+1} \right )\)</span> can be replaced by <span class="math inline">\(\mathbb{I}\left ( \max_{l_1} \left (r_{k_1 1 l_1 1} \right ) = i \right )\)</span>, <span class="math inline">\(\mathbb{I}\left ( \zeta_i \leq z_{k_2 2l_22} &lt; \zeta_{i+1} \right )\)</span> can be replaced by <span class="math inline">\(\mathbb{I}\left ( r_{k_2 2l_22} = i \right )\)</span> and <span class="math inline">\(\mathbb{I}\left (z_{k_2 2l_22} \geq \zeta_{i+1} \right )\)</span> can be replaced by <span class="math inline">\(\mathbb{I}\left (r_{k_2 2l_22} &gt; i \right )\)</span>. Then Eqn. <a href="empirical.html#eq:empirical-theorem2">(3.26)</a> can be re-written as:</p>
<p><span class="math display" id="eq:empirical-theorem5">\[\begin{equation}
\left. 
\begin{aligned}
\text{A}_i =&amp; \frac{1}{K_1K_2}  \sum_{k_2=1}^{K_2} \sum_{l_2=1}^{l_{k_2}}\sum_{k_1=1}^{K_1} \\
&amp;\left [ \frac{1}{2} W_{k_2l_2} \mathbb{I}\left ( \max_{l_1} \left (r_{k_1 1 l_1 1}  \right ) = i  \right )\mathbb{I}\left ( r_{k_2 2 l_2 2} = i\right ) \right. \\
+&amp; \left. \mathbb{I}\left ( \max_{l_1} \left (r_{k_1 1 l_1 1}  \right ) = i  \right )\mathbb{I}\left ( r_{k_2 2 l_2 2} &gt; i \right )  \right ]
\end{aligned}
\right \} 
\tag{3.30}
\end{equation}\]</span></p>
<p>Eqn. <a href="empirical.html#eq:empirical-theorem5">(3.30)</a> follows from the property of the indicator function, which constrains <span class="math inline">\(i\)</span> in the indicator functions inside the square bracket in Eqn. (17) to <span class="math inline">\(\max_{l_1} \left ( r_{k_1 1 l_1 1} \right )\)</span>, where the functions are unity and otherwise they are zero.</p>
<p>Summing over all values of <span class="math inline">\(i\)</span>, one gets for the total area under the empirical wAFROC plot:</p>
<p><span class="math display" id="eq:empirical-theorem6">\[\begin{equation}
\begin{aligned}
\text{A}_{wAFROC} =&amp; \frac{1}{K_1K_2}  \sum_{k_2=1}^{K_2} \sum_{l_2=1}^{l_{k_2}}\sum_{k_1=1}^{K_1} W_{k_2l_2} \left( A+B \right)
\end{aligned}
\tag{3.31}
\end{equation}\]</span></p>
<p>where A and B are defined by:</p>
<p><span class="math display" id="eq:empirical-theorem6a">\[\begin{equation}
\left. 
\begin{aligned}
A =&amp; \mathbb{I}\left ( r_{k_2 2l_2 2} = \max_{l_1} \left (r_{k_1 1l_1 1}  \right )  \right ) \\
B =&amp; \mathbb{I}\left ( r_{k_22 l_2 2} &gt; \max_{l_1} \left (r_{k_11 l_1 1}  \right )  \right )  
\end{aligned}
\right \} 
\tag{3.32}
\end{equation}\]</span></p>
<p>Defining the Wilcoxon kernel function <span class="math inline">\(\psi(x,y)\)</span> by:</p>
<p><span class="math display" id="eq:empirical-wilcoxon-kernel">\[\begin{equation}
\left. 
\begin{matrix}
\begin{aligned}
&amp;\psi\left( x,y \right) = 1 &amp;  x &lt; y\\
&amp;\psi\left( x,y \right) = 0.5  &amp; x = y \\
&amp;\psi\left( x,y \right) = 0  &amp; x &gt; y
\end{aligned}
\end{matrix}
\right \} 
\tag{3.33}
\end{equation}\]</span></p>
<p>It follows that:</p>
<p><span class="math display" id="eq:empirical-theorem7">\[\begin{equation}
\begin{aligned}
\text{A}_{wAFROC} =&amp; \frac{1}{K_1K_2}  \sum_{k_2=1}^{K_2} \sum_{l_2=1}^{l_{k_2}}\sum_{k_1=1}^{K_1} W_{k_2l_2} \psi\left ( \max_{l_1} \left ( r_{k_1 1 l_1 1} \right ) , r_{k_2 2 l_2 2} \right )
\end{aligned}
\tag{3.34}
\end{equation}\]</span></p>
<p>This formula is the wAFROC analog of the familiar Bamber theorem <span class="citation">(Bamber <a href="#ref-bamber1975area" role="doc-biblioref">1975</a>)</span> relating the empirical AUC under the ROC to the ratings:</p>
<p><span class="math display" id="eq:empirical-bamber-theorem">\[\begin{equation}
\text{A}_{ROC} = \frac{1}{K_1K_2}  \sum_{k_2=1}^{K_2} \sum_{k_1=1}^{K_1} \psi\left (  r_{k_11} , r_{k_22} \right )
\tag{3.35}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(r_{k_11}\)</span> and <span class="math inline">\(r_{k_22}\)</span> are the ROC ratings of non-diseased case <span class="math inline">\(k_11\)</span> and diseased case <span class="math inline">\(k_22\)</span> respectively.</p>
</div>
<div id="empirical-theorem-2" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.16</span> Appendix 2: Interpretation of area under straight line extension of wAFROC<a href="empirical.html#empirical-theorem-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We prove that the contribution of the <span class="math inline">\(i = 0\)</span> term in Eqn. <a href="empirical.html#eq:empirical-theorem5">(3.30)</a> is identical to the area under the extension of the wAFROC from the uppermost empirical operating point to (1,1).</p>
<p>According to Eqn. <a href="empirical.html#eq:empirical-theorem5">(3.30)</a>,</p>
<p><span class="math display" id="eq:empirical-theorem8">\[\begin{equation}
\left. 
\begin{aligned}
\text{A}_0 =&amp; \frac{1}{K_1K_2}  \sum_{k_2=1}^{K_2} \sum_{l_2=1}^{l_{k_2}}\sum_{k_1=1}^{K_1} \\
&amp;\left [ \frac{1}{2} W_{k_2l_2} \mathbb{I}\left ( \max_{l_1} \left (r_{k_1 1 l_1 1}  \right ) = 0  \right )\mathbb{I}\left ( r_{k_2 2 l_2 2} = 0 \right ) \right. \\
+&amp; \left. \mathbb{I}\left ( \max_{l_1} \left (r_{k_1 1 l_1 1}  \right ) = 0  \right )\mathbb{I}\left ( r_{k_2 2 l_2 2} &gt; 0 \right )  \right ]
\end{aligned}
\right \} 
\tag{3.36}
\end{equation}\]</span></p>
<p>Rearranging the summations:</p>
<p><span class="math display" id="eq:empirical-theorem9">\[\begin{equation}
\left. 
\begin{aligned}
\text{A}_0 =&amp; 
\frac{1}{2} \frac{1}{K_1} \sum_{k_1=1}^{K_1}\mathbb{I}\left ( \max_{l_1} \left (r_{k_1 1 l_1 1}  \right ) = 0  \right ) \frac{1}{K_2} \sum_{k_2=1}^{K_2} \sum_{l_2=1}^{l_{k_2}} W_{k_2l_2} \mathbb{I}\left ( r_{k_2 2 l_2 2} = 0 \right ) \\
+&amp; \frac{1}{K_1} \sum_{k_1=1}^{K_1}\mathbb{I}\left ( \max_{l_1} \left (r_{k_1 1 l_1 1}  \right ) = 0  \right ) \frac{1}{K_2} \sum_{k_2=1}^{K_2} \sum_{l_2=1}^{l_{k_2}} W_{k_2l_2} \mathbb{I}\left ( r_{k_2 2 l_2 2} &gt; 0 \right )
\end{aligned}
\right \} 
\tag{3.37}
\end{equation}\]</span></p>
<p>Consider the term:</p>
<p><span class="math display" id="eq:empirical-theorem9a">\[\begin{equation}
\frac{1}{K_1} \sum_{k_1=1}^{K_1}\mathbb{I}\left ( \max_{l_1} \left (r_{k_1 1 l_1 1}  \right ) = 0  \right )
\tag{3.38}
\end{equation}\]</span></p>
<p>Because the indicator function and the summation over <span class="math inline">\(k_1\)</span> counts the numbers of unmarked non-diseased cases and the division by <span class="math inline">\(K_1\)</span> yields the corresponding contribution to <span class="math inline">\(\text{FPF}\)</span>, the above term equals the complement of the largest observed <span class="math inline">\(\text{FPF}\)</span> value, <span class="math inline">\(\text{FPF}_1\)</span>, obtained by cumulating all non-zero ratings, i.e, 1 and above. It follows that:</p>
<p><span class="math display" id="eq:empirical-theorem10">\[\begin{equation}
\begin{aligned}
\frac{1}{K_1}\sum_{k_1=1}^{K_1}\mathbb{I}\left ( \max_{l_1} \left (r_{k_1 1 l_1 1}  \right ) = 0  \right ) = 1 - \text{FPF}_1
\end{aligned}
\tag{3.39}
\end{equation}\]</span></p>
<p>Similarly,</p>
<p><span class="math display" id="eq:empirical-theorem11">\[\begin{equation}
\begin{aligned}
\frac{1}{K_2}\sum_{k_2=1}^{K_2} \sum_{l_2=1}^{l_{k_2}} W_{k_2l_2} \mathbb{I}\left ( r_{k_2 2 l_2 2}  = 0  \right ) = 1 - \text{wLLF}_1
\end{aligned}
\tag{3.40}
\end{equation}\]</span></p>
<p>Using these expressions, Eqn. <a href="empirical.html#eq:empirical-theorem9">(3.37)</a> reduces to:</p>
<p><span class="math display" id="eq:empirical-theorem12">\[\begin{equation}
\begin{aligned}
\text{A}_0 = \frac{\left ( 1-\text{FPF}_1 \right ) \left ( 1+\text{wLLF}_1 \right )}{2}
\end{aligned}
\tag{3.41}
\end{equation}\]</span></p>
<p>The area under the straight line extension of the wAFROC from the observed end-point <span class="math inline">\(\left ( \text{FPF}_1, \text{wLLF}_1 \right )\)</span> to (1,1) equals the area of a rectangle with base <span class="math inline">\(\left ( 1-\text{FPF}_1 \right )\)</span> and height <span class="math inline">\(\text{wLLF}_1\)</span> plus the area of a triangle with base <span class="math inline">\(\left ( 1-\text{FPF}_1 \right )\)</span> and height <span class="math inline">\((1-\text{wLLF}_1)\)</span>:</p>
<p><span class="math display" id="eq:empirical-theorem12a">\[\begin{equation}
\left. 
\begin{aligned}
\text{Area st. line ext.} =&amp; \left ( 1-\text{FPF}_1 \right )\text{wLLF}_1 
+ \frac{\left( 1-\text{FPF}_1 \right )\left ( 1-\text{wLLF}_1 \right )}{2}  \\
=&amp; \left ( 1-\text{FPF}_1 \right )\left( \text{wLLF}_1 + \frac{\left ( 1-\text{wLLF}_1 \right )}{2} \right) \\
=&amp;
\frac{\left ( 1-\text{FPF}_1 \right ) \left ( 1+\text{wLLF}_1 \right )}{2}
\end{aligned}
\right \} 
\tag{3.42}
\end{equation}\]</span></p>
<p>which equals the right hand side of Eqn. <a href="empirical.html#eq:empirical-theorem12">(3.41)</a>.</p>
<blockquote>
<p>In other words <span class="math inline">\(A_0\)</span> is the area under the extension of the wAFROC from observed end-point <span class="math inline">\(\left ( \text{FPF}_1, \text{wLLF}_1 \right )\)</span> to (1,1).</p>
</blockquote>
<p>According to Eqn. <a href="empirical.html#eq:empirical-theorem12">(3.41)</a>, <span class="math inline">\(A_0\)</span> increases as <span class="math inline">\(\text{FPF}_1\)</span> decreases, i.e., as more non-diseased cases are <em>not marked</em> and as <span class="math inline">\(\text{wLLF}_1\)</span> increases, i.e., as more lesions, especially those with greater weights, <em>are marked</em>. Both observations are in keeping with the behavior of a valid performance measure.</p>
<blockquote>
<ul>
<li>Failure to include the area under the straight-line extension results in not counting the full contribution to the FOM of unmarked non-diseased cases and unmarked lesions. This is best seen by considering the case of a perfect observer.</li>
<li>For a perfect observer whose plot is the vertical line from (0,0) to (0,1) followed by the horizontal line from (0,1) to (1,1), <em>the area under the straight-line extension comprises the entire AUC</em>. Excluding it would yield zero AUC for a perfect observer which is obviously incorrect.</li>
<li>Stated equivalently, for the perfect observer <span class="math inline">\(\text{FPF}_1 = 0\)</span> and <span class="math inline">\(\text{wLLF}_1 = 1\)</span> and then, according to Eqn. <a href="empirical.html#eq:empirical-theorem12">(3.41)</a>, the area under the straight line extension is <span class="math inline">\(A_0 = 1\)</span>.</li>
</ul>
</blockquote>
</div>
<div id="empirical-summary-computational-formulae" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.17</span> Appendix 3: Summary of computational formulae<a href="empirical.html#empirical-summary-computational-formulae" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="froc" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.17.1</span> FROC<a href="empirical.html#froc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The formula for the area under the empirical FROC plot follows:</p>
<p><span class="math display" id="eq:empirical-computational-froc">\[\begin{equation}
\begin{aligned}
\text{A}_{FROC} =&amp; \frac{1}{\left ( K_1+K_2 \right )\sum_{k_2=1}^{K_2}L_{k_2 2}}\sum_{k_2=1}^{K_2}\sum_{l_2=1}^{L_{k_2 2}} \left( A+B \right)
\end{aligned}
\tag{3.43}
\end{equation}\]</span></p>
<p>where A and B are defined by:</p>
<p><span class="math display" id="eq:empirical-computational-froc-ab-terms">\[\begin{equation}
\left. 
\begin{aligned}
A =&amp; \sum_{k_1=1}^{K_1}\sum_{l_1=1}^{N_{k_1 1}} \mathbb{I} \left ( z_{k_11l_11} \neq  -\infty \right ) \psi\left ( z_{k_11l_11},z_{k_22l_22} \right )\\
B =&amp;\sum_{k_2&#39;=1}^{K_2}\sum_{l_1=1}^{N_{k_2&#39; 2}} \mathbb{I} \left ( z_{z_{k&#39;_22l_11}} \neq  -\infty \right )\psi\left ( z_{k_2&#39;2l_11},z_{k_22l_22} \right )
\end{aligned}
\right \} 
\tag{3.44}
\end{equation}\]</span></p>
<p>For term A, <span class="math inline">\(\mathbb{I} \left ( z_{k_11l_11} \neq -\infty \right )\)</span> ensures that only <em>finite</em> NL z-samples on non-diseased cases enter the computation (recall that unmarked NLs are unobservable events). Likewise, for term B, <span class="math inline">\(\mathbb{I} \left ( z_{k&#39;_22l_11} \neq -\infty \right )\)</span> ensures that only <em>finite</em> NL z-samples on diseased cases enter the computation. This is not needed for LLs since unmarked LLs are observable events. In term A the double summation compares using the <span class="math inline">\(\psi\)</span> function all finite NL ratings on <em>non-diseased</em> cases <span class="math inline">\(k_11\)</span> with all lesion ratings on diseased case <span class="math inline">\(k_22\)</span>. In term B the double summation compares all finite NL ratings on <em>diseased cases</em> <span class="math inline">\(k_2&#39;2\)</span> with all lesion ratings on diseased case <span class="math inline">\(k_22\)</span>. The double summation in Eqn. <a href="empirical.html#eq:empirical-computational-froc">(3.43)</a> sums over all diseased cases <span class="math inline">\(k_22\)</span> and all lesions in each diseased case. The final value is divided by the total number of cases and the total number of lesions.</p>
<p>In term B notice the need to distinguish between two indices for diseased cases <span class="math inline">\(z_{k&#39;_22l_11}\)</span> and <span class="math inline">\(z_{k_22l_22}\)</span>.</p>
<p>The above formula is equivalent to creating two arrays the first containing all finite NL ratings and the second containing all lesion ratings (including unmarked lesions). One cumulates the<span class="math inline">\(\psi\)</span> function values, using the ratings in the two arrays, and divides by the total number of cases and by the total number of lesions.</p>
<p>The following example uses the same 9-case FROC dataset used earlier. The AUC is calculated two ways: using geometry and using Eqn. <a href="empirical.html#eq:empirical-computational-froc">(3.43)</a> implemented in function <code>UtilFigureOfMerit</code>.</p>
<pre><code>#&gt; numerical integration yields:  0.4074074
#&gt; RJafroc yields:  0.4074074</code></pre>
</div>
<div id="roc" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.17.2</span> ROC<a href="empirical.html#roc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The ROC-AUC formula is much simpler.</p>
<p><span class="math display" id="eq:empirical-computational-roc">\[\begin{equation}
\begin{aligned}
\text{A}_{ROC} = \frac{1}{K_1K_2}\sum_{k_1=1}^{K_1}\sum_{k_2=1}^{K_2} \psi\left ( \max_{l_1}\left (z_{k_11l_11} \right ), \max_{l_1l_2}\left (z_{k_22l_11}, z_{k_22l_22}  \right ) \right )
\end{aligned}
\tag{3.45}
\end{equation}\]</span></p>
<p>The first argument of the <span class="math inline">\(\psi\)</span> function is the maximum NL rating on a non-diseased case or <span class="math inline">\(-\infty\)</span> if the case has no NL marks. The second argument is the maximum of all marks, NL or LL, on a diseased case, or <span class="math inline">\(-\infty\)</span> if the case has no marks. The value of the <span class="math inline">\(\psi\)</span> function is summed over all non-diseased and diseased cases and divided by <span class="math inline">\(K_1\)</span> and <span class="math inline">\(K_2\)</span>, analogous to the Bamber theorem Eqn. <a href="empirical.html#eq:empirical-bamber-theorem">(3.35)</a>.</p>
</div>
<div id="afroc" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.17.3</span> AFROC<a href="empirical.html#afroc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The formula for the area under the empirical AFROC plot follows:</p>
<p><span class="math display" id="eq:empirical-computational-afroc">\[\begin{equation}
\begin{aligned}
\text{A}_{AFROC} = \frac{1}{K_1\sum_{k_2=1}^{K_2}L_{k_2 2}}\sum_{k_1=1}^{K_1}\sum_{k_2=1}^{K_2}\sum_{l_2=1}^{L_{k_2 2}} \psi\left ( \max_{l_1}\left (z_{k_11l_11}  \right ),z_{k_22l_22} \right )
\end{aligned}
\tag{3.46}
\end{equation}\]</span></p>
<p>The first argument of the <span class="math inline">\(\psi\)</span> function is the maximum NL rating on a non-diseased case or <span class="math inline">\(-\infty\)</span> if the case has no NL marks. The second argument is the LL rating on a diseased case. The value of the <span class="math inline">\(\psi\)</span> function is summed over all non-diseased cases and all lesions and divided by <span class="math inline">\(K_1\)</span> and the total number of lesions.</p>
</div>
<div id="wafroc" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.17.4</span> wAFROC<a href="empirical.html#wafroc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The formula for the area under the empirical wAFROC plot follows:</p>
<p><span class="math display" id="eq:empirical-computational-wafroc">\[\begin{equation}
\begin{aligned}
\text{A}_{wAFROC} = \frac{1}{K_1K_2}\sum_{k_1=1}^{K_1}\sum_{k_2=1}^{K_2}\sum_{l_2=1}^{L_{k_2 2}} W_{k_2l_2}\psi\left ( \max_{l_1}\left (z_{k_11l_11}  \right ),z_{k_22l_22} \right )
\end{aligned}
\tag{3.47}
\end{equation}\]</span></p>
<p>This is similar to Eqn. <a href="empirical.html#eq:empirical-computational-afroc">(3.46)</a> except for the inclusion of the lesion weight term <span class="math inline">\(W_{k_2l_2}\)</span> inside the summations.</p>
<p>The FOM-statistic <span class="math inline">\(\text{A}_{wAFROC}\)</span> achieves its highest value, unity, if and only if every lesion is rated higher than any mark on non-diseased cases, for then the <span class="math inline">\(\psi\)</span> function always yields unity, and the summations yield unity. If, on the other hand, every lesion is rated lower than every mark on every non-diseased case, the <span class="math inline">\(\psi\)</span> function always yields zero, and the FOM-statistic is zero. Therefore, <span class="math inline">\(0 \leq \text{A}_{wAFROC} \leq 1\)</span>. This shows that <span class="math inline">\(\text{A}_{wAFROC}\)</span> behaves like a probability and its range is <em>twice</em> that of <span class="math inline">\(\text{A}_{ROC}\)</span>; recall that <span class="math inline">\(0.5 \leq \text{A}_{ROC} \leq 1\)</span> (assuming the observer has equal or better than random performance and the observer does not have the direction of the rating scale reversed). This has the consequence that treatment related differences between <span class="math inline">\(\text{A}_{wAFROC}\)</span> (i.e., effect sizes) are larger relative to the corresponding ROC effect sizes (just as temperature differences in the Fahrenheit scale are larger than the same differences expressed in the Celsius scale). This has important implications for FROC sample size estimation, see <a href="https://dpc10ster.github.io/RJafrocQuickStart/froc-sample-size.html">sample size chapter</a> in the <code>RJafrocQuickStart</code> book.</p>
<p>The range <span class="math inline">\(0 \leq \text{A}_{wAFROC} \leq 1\)</span> is one reason why the “chance diagonal” of the AFROC, corresponding to <span class="math inline">\(\text{A}_{wAFROC} = 0.5\)</span>, does <em>not</em> reflect chance-level performance. <span class="math inline">\(\text{A}_{AFROC} = 0.5\)</span> is actually reasonable performance, being exactly in the middle of the allowed range. An example of this was given above for the case of an expert radiologist who does not mark any cases.</p>
<p>Similar comments apply to the AFROC_AUC, i.e. <span class="math inline">\(0 \leq \text{A}_{AFROC} \leq 1\)</span>, etc.</p>
</div>
<div id="afroc1" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.17.5</span> AFROC1<a href="empirical.html#afroc1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display" id="eq:empirical-computational-afroc1">\[\begin{equation}
\begin{aligned}
\text{A}_{AFROC1} =&amp; \frac{1}{\left (K_1 +K_2 \right )\sum_{k_2=1}^{K_2}L_{k_2 2}}\sum_{k_2=1}^{K_2}\sum_{l_2=1}^{L_{k_2 2}} \left( A + B \right)
\end{aligned}
\tag{3.48}
\end{equation}\]</span></p>
<p>where A and B are defined by:</p>
<p><span class="math display" id="eq:empirical-computational-afroc1ab">\[\begin{equation}
\left. 
\begin{aligned}
A =&amp; \sum_{k_1=1}^{K_1}\psi\left ( \max_{l_1}\left (z_{k_11l_11}  \right ),z_{k_22l_22} \right ) \\
B =&amp; \sum_{k_2&#39;=1}^{K_2}\psi\left ( \max_{l_1}\left (z_{k_22l_11}&#39;  \right ),z_{k_22l_22} \right )
\end{aligned}
\right \} 
\tag{3.49}
\end{equation}\]</span></p>
<p>The normalization can checked by assuming all NL ratings are less than any LL rating, in which case terms A and B reduce to <span class="math inline">\(K_1+K_2\)</span> and <span class="math inline">\(\text{A}_{AFROC1} = 1\)</span>:</p>
<p><span class="math display" id="eq:empirical-computational-afroc1a">\[\begin{equation}
\left. 
\begin{aligned}
\text{A}_{AFROC1} =&amp; \frac{1}{\sum_{k_2=1}^{K_2}L_{k_2 2}}\sum_{k_2=1}^{K_2}\sum_{l_2=1}^{L_{k_2 2}} 1 \\
=&amp; \frac{1}{\sum_{k_2=1}^{K_2}L_{k_2 2}}\sum_{k_2=1}^{K_2}L_{k_2 2} \\
=&amp; 1
\end{aligned}
\right \} 
\tag{3.50}
\end{equation}\]</span></p>
</div>
<div id="wafroc1" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.17.6</span> wAFROC1<a href="empirical.html#wafroc1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is similar to the above expression for AFROC1 except for the presence of the weight term <span class="math inline">\(W_{k_2l_2}\)</span>:</p>
<p><span class="math display" id="eq:empirical-computational-wafroc1">\[\begin{equation}
\begin{aligned}
\text{A}_{wAFROC1} =&amp; \frac{1}{\left (K_1 + K_2 \right )K_2}\sum_{k_2=1}^{K_2}\sum_{l_2=1}^{L_{k_2 2}} W_{k_2l_2}\left( A+B \right)
\end{aligned}
\tag{3.51}
\end{equation}\]</span></p>
<p>A and B are as defined in Eqn. <a href="empirical.html#eq:empirical-computational-afroc1ab">(3.49)</a>.</p>

</div>
</div>
</div>



<h3>REFERENCES<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references">
<div id="ref-bamber1975area">
<p>Bamber, Donald. 1975. “The Area Above the Ordinal Dominance Graph and the Area Below the Receiver Operating Characteristic Graph.” <em>Journal of Mathematical Psychology</em> 12 (4): 387–415.</p>
</div>
<div id="ref-bunch1977free">
<p>Bunch, Philip C, John F Hamilton, Gary K Sanderson, and Arthur H Simmons. 1977. “A Free Response Approach to the Measurement and Characterization of Radiographic Observer Performance.” In <em>Application of Optical Instrumentation in Medicine Vi</em>, 127:124–35. International Society for Optics; Photonics.</p>
</div>
<div id="ref-chakraborty1989maximum">
<p>Chakraborty, Dev P. 1989. “Maximum Likelihood Analysis of Free-Response Receiver Operating Characteristic (Froc) Data.” <em>Medical Physics</em> 16 (4): 561–68.</p>
</div>
<div id="ref-chakraborty2006search">
<p>Chakraborty, Dev P. 2006. “A Search Model and Figure of Merit for Observer Data Acquired According to the Free-Response Paradigm.” <em>Physics in Medicine &amp; Biology</em> 51 (14): 3449.</p>
</div>
<div id="ref-RN1385">
<p>Chakraborty, Dev P., and K. S. Berbaum. 2004. “Observer Studies Involving Detection and Localization: Modeling, Analysis and Validation.” Journal Article. <em>Med Phys</em> 31 (8): 2313–30.</p>
</div>
<div id="ref-RN1966">
<p>Chakraborty, Dev P., and H. J. Yoon. 2009. “JAFROC Analysis Revisited: Figure-of-Merit Considerations for Human Observer Studies.” Journal Article. <em>Proc. SPIE Medical Imaging: Image Perception, Observer Performance, and Technology Assessment</em> 7263: 72630T.</p>
</div>
<div id="ref-RN2484">
<p>Chakraborty, Dev P, and Xuetong Zhai. 2016. “On the Meaning of the Weighted Alternative Free-Response Operating Characteristic Figure of Merit.” Journal Article. <em>Medical Physics</em> 43 (5): 2548–57.</p>
</div>
<div id="ref-desantis2011breast">
<p>DeSantis, Carol, Rebecca Siegel, Priti Bandi, and Ahmedin Jemal. 2011. “Breast Cancer Statistics, 2011.” <em>CA: A Cancer Journal for Clinicians</em> 61 (6): 408–18.</p>
</div>
<div id="ref-duchowski2017eye">
<p>Duchowski, Andrew T, and Andrew T Duchowski. 2017. <em>Eye Tracking Methodology: Theory and Practice</em>. Springer.</p>
</div>
<div id="ref-swensson1996unified">
<p>Swensson, Richard G. 1996. “Unified Measurement of Observer Performance in Detecting and Localizing Target Objects on Images.” <em>Medical Physics</em> 23 (10): 1709–25.</p>
</div>
<div id="ref-zanca2009evaluation">
<p>Zanca, Federica, Jurgen Jacobs, Chantal Van Ongeval, Filip Claus, Valerie Celis, Catherine Geniets, Veerle Provost, Herman Pauwels, Guy Marchal, and Hilde Bosmans. 2009. “Evaluation of Clinical Image Processing Algorithms Used in Digital Mammography.” <em>Medical Physics</em> 36 (3): 765–75.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="14">
<li id="fn14"><p>Currently the best insight into the numbers and locations of marks per case is obtained from eye-tracking studies <span class="citation">(Duchowski and Duchowski <a href="#ref-duchowski2017eye" role="doc-biblioref">2017</a>)</span>, but the information is incomplete as eye-tracking studies can only measure <em>foveal</em> gaze and not lesions found by <em>peripheral</em> vision. Moreover, such studies are near impossible to conduct in a clinical setting (at least with the eye-tracking apparatus that I am familiar with).<a href="empirical.html#fnref14" class="footnote-back">↩︎</a></p></li>
<li id="fn15"><p>The subscript is used to make explicit the paradigm used as otherwise it leads to confusion.<a href="empirical.html#fnref15" class="footnote-back">↩︎</a></p></li>
<li id="fn16"><p>I expected the number of NL marks per image to be limited only by the ratio of image size to lesion size, i.e., larger values for smaller lesions.<a href="empirical.html#fnref16" class="footnote-back">↩︎</a></p></li>
<li id="fn17"><p>This is not a limiting assumption: if the data is continuous, for finite numbers of cases, no ordering information is lost if the number of ratings is chosen large enough.<a href="empirical.html#fnref17" class="footnote-back">↩︎</a></p></li>
<li id="fn18"><p>The highest rating method was used in early FROC modeling in <span class="citation">(Bunch et al. <a href="#ref-bunch1977free" role="doc-biblioref">1977</a>)</span> and in <span class="citation">(Swensson <a href="#ref-swensson1996unified" role="doc-biblioref">1996</a>)</span>, the latter in the context of LROC paradigm modeling.<a href="empirical.html#fnref18" class="footnote-back">↩︎</a></p></li>
<li id="fn19"><p>Historical note: I became aware of how serious this issue could be when a researcher contacted me about using FROC methodology for nuclear medicine bone scan images, where the number of lesions on diseased cases can vary from a few to a hundred!<a href="empirical.html#fnref19" class="footnote-back">↩︎</a></p></li>
<li id="fn20"><p>The jumps need not be contiguous: they will be contiguous only if the three lesion z-samples are closely spaced such that they are crossed in succession, in any order, by the sliding virtual threshold; otherwise the jumps will be interspersed by jumps from lesions in other cases.<a href="empirical.html#fnref20" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="froc-paradigm.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="visual-search.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["RJafrocFrocBook.pdf", "RJafrocFrocBook.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
